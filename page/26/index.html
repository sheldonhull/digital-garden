
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../welcome/">
      
      
        <link rel="next" href="../../2023/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>posts - digital garden</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/gist.css">
    
      <link rel="stylesheet" href="../../stylesheets/code-highlighting.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#posts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="digital garden" class="md-header__button md-logo" aria-label="digital garden" data-md-component="logo">
      
  <img src="../../assets/images/sheldon-avatar.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            digital garden
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              posts
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sheldonhull/digital-garden" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../welcome/" class="md-tabs__link">
        
  
    
  
  home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  posts

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/tooling/task/" class="md-tabs__link">
          
  
    
  
  notes

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../2023/" class="md-tabs__link">
          
  
    
  
  archive

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="digital garden" class="md-nav__button md-logo" aria-label="digital garden" data-md-component="logo">
      
  <img src="../../assets/images/sheldon-avatar.jpg" alt="logo">

    </a>
    digital garden
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sheldonhull/digital-garden" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../welcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    posts
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="../.." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    posts
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#powershell-module-improvements-for-sql-server-in-2017" class="md-nav__link">
    <span class="md-ellipsis">
      Powershell Module Improvements for SQL Server in 2017
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-influxdb-as-a-service-in-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Running InfluxDB as a service in Windows
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-influxdb-chronograf-and-grafana-for-the-sqlserver-dev" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up InfluxDb, Chronograf, and Grafana for the SqlServer Dev
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automate-windows-updates-for-development" class="md-nav__link">
    <span class="md-ellipsis">
      Automate Windows Updates for Development
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programming-fonts-for-the-newb" class="md-nav__link">
    <span class="md-ellipsis">
      Programming Fonts For The Newb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tfs-custom-task-service-actions-for-tfs-2015-update-21-or-before" class="md-nav__link">
    <span class="md-ellipsis">
      TFS Custom Task - Service Actions (for TFS 2015 Update 2.1 or before)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red-gate-sql-clone-1-initial-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Red Gate SQL Clone (1) - Initial Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#life-hack-when-you-need-a-mouse-pad" class="md-nav__link">
    <span class="md-ellipsis">
      Life Hack: When you need a mouse pad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implicit-transactions" class="md-nav__link">
    <span class="md-ellipsis">
      Implicit Transactions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-way-to-run-powershell-tasks-in-parallel" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Way to Run Powershell Tasks in Parallel
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Development
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/tooling/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tooling
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            Tooling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/tooling/task/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    task
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/tooling/precommit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    precommit
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/tooling/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/tooling/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/tooling/direnv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    direnv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/tooling/aqua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aqua
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/shell/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Shell
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Shell
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/shell/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/powershell/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Powershell
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            Powershell
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/powershell/powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    powershell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/powershell/pester/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pester
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/powershell/dbatools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dbatools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/observability/observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    observability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/level-up/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level-Up
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/kubernetes/kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kubernetes
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/go/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Go
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_8" id="__nav_3_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_8">
            <span class="md-nav__icon md-icon"></span>
            Go
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/vscode-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VSCode Configuration for Go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/using-go-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Go Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/pre-commit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre-Commit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/mage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go Logging
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/goroutines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    goroutines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/effective-go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Effective Go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/dagger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dagger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/go/code-coverage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Coverage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/front-end/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Front end
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_9" id="__nav_3_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_9">
            <span class="md-nav__icon md-icon"></span>
            Front end
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/front-end/yarn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Yarn
  </span>
  

      </a>
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/build-release-engineering/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Build release engineering
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_10" id="__nav_3_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_10">
            <span class="md-nav__icon md-icon"></span>
            Build release engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/build-release-engineering/renovate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    renovate
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/build-release-engineering/azure-pipelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Pipelines
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/aws/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Aws
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_11" id="__nav_3_1_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_11">
            <span class="md-nav__icon md-icon"></span>
            Aws
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/aws/s5cmd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syncing Files Using S5Cmd
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/aws/aws-powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS PowerShell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/aws/aws-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-cli
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/ai/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Ai
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_12" id="__nav_3_1_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_12">
            <span class="md-nav__icon md-icon"></span>
            Ai
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/ai/copilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    copilot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/ai/chat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chat
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Career
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Career
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../career/management-dynamics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Management Dynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../career/eponymous-laws/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Eponymous Laws
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../career/engineering-culture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Engineering Culture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../career/communication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Communication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2017
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2016/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2016
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2015/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2015
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2014/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2014
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2013/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2013
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#powershell-module-improvements-for-sql-server-in-2017" class="md-nav__link">
    <span class="md-ellipsis">
      Powershell Module Improvements for SQL Server in 2017
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-influxdb-as-a-service-in-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Running InfluxDB as a service in Windows
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-influxdb-chronograf-and-grafana-for-the-sqlserver-dev" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up InfluxDb, Chronograf, and Grafana for the SqlServer Dev
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automate-windows-updates-for-development" class="md-nav__link">
    <span class="md-ellipsis">
      Automate Windows Updates for Development
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programming-fonts-for-the-newb" class="md-nav__link">
    <span class="md-ellipsis">
      Programming Fonts For The Newb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tfs-custom-task-service-actions-for-tfs-2015-update-21-or-before" class="md-nav__link">
    <span class="md-ellipsis">
      TFS Custom Task - Service Actions (for TFS 2015 Update 2.1 or before)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red-gate-sql-clone-1-initial-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Red Gate SQL Clone (1) - Initial Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#life-hack-when-you-need-a-mouse-pad" class="md-nav__link">
    <span class="md-ellipsis">
      Life Hack: When you need a mouse pad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implicit-transactions" class="md-nav__link">
    <span class="md-ellipsis">
      Implicit Transactions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-way-to-run-powershell-tasks-in-parallel" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Way to Run Powershell Tasks in Parallel
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="posts">posts<a class="headerlink" href="#posts" title="Permanent link">🔗</a></h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-05-31 00:00:00">May 31, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="powershell-module-improvements-for-sql-server-in-2017"><a class="toclink" href="../../powershell-module-improvements-for-sql-server-in-2017/">Powershell Module Improvements for SQL Server in 2017</a></h2>
<p>{{&lt; admonition type="info" title="Updated: 2018-03-19" &gt;}}
I don't use these much, if any now. Check out dbatools which is a much better module with a full range of features to save you a ton of time.
{{&lt; /admonition &gt;}}</p>
<h2 id="simple-setup"><a class="toclink" href="../../powershell-module-improvements-for-sql-server-in-2017/#simple-setup">simple setup</a></h2>
<p>A major improvement that seems to have quietly slipped into the sql developers world is an improved SQLServer powershell module. The improved module is finally available in the powershell gallery, allowing a super quick setup on a server. No more installing SSMS to get them!</p>
<p>This is very promising, and great if you want to leverage some of the functionality on various build servers, or other machines that might not have SSMS installed.</p>
<p><a href="http://bit.ly/2pOwVtj">Powershell Gallery - SqlServer</a></p>
<h2 id="new-cmdlets"><a class="toclink" href="../../powershell-module-improvements-for-sql-server-in-2017/#new-cmdlets">new cmdlets</a></h2>
<p>In reviewing, I ran across a few new cmdlet's as well. For instance, you could easily right click on a table and output the results into a powershell object, json, csv, gridview, or anything else you want. This is great flexibility.</p>
<p><img alt="exploring-sql-path-provider" src="../../2017/images/exploring-sql-path-provider.png" /></p>
<p>In versions of SQL Server (as of 2012 or earlier) I believe the version SQL Server was utilizing was out of date with the installed version. For instance, on Windows Server 2012 with Powershell ISE reporting PsVersion of 4.0, Sql Server reported version 2.0 being utilized.</p>
<p>In 2014 instances I had, the powershell invoked from SSMS shows the matching up to date version, which gives much better capability and functionality.</p>
<h2 id="simple-benefits-for-the-inquiring-mind"><a class="toclink" href="../../powershell-module-improvements-for-sql-server-in-2017/#simple-benefits-for-the-inquiring-mind">simple benefits for the inquiring mind</a></h2>
<p>If you are not familar with the potentional benefits from being able to quickly invoke a powershell prompt and use SQL server cmdlets (prebuilt functionality that is easily called), I can give you a few use cases.</p>
<p>If you were asked to run a query, then export the results to a spreadsheet, it would be relatively simple as a cut and paste. However, if you needed to loop through every table in the database, and put each one to it's own excel workbook, powershell would allow you to quickly loop, convert the datatable returned into an excel worksheet, and either append into new worksheets, or create completely seperate new files. For automation possibilities, you've got a tremendous amount of potentional time savings if you can get comfortable with powershell.</p>
<p>In my case, I've found Powershell to be a great tool to help me understand more of the .NET framework as I use various cmdlets or .NET accelerators.</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-05-24 00:00:00">May 24, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="running-influxdb-as-a-service-in-windows"><a class="toclink" href="../../running-influx-db-as-a-service-in-windows/">Running InfluxDB as a service in Windows</a></h2>
<h3 id="run-as-a-service"><a class="toclink" href="../../running-influx-db-as-a-service-in-windows/#run-as-a-service">Run as a Service</a></h3>
<p>As part of the process to setup some metrics collections for sql-server based on perfmon counters I've been utilizing InfluxDB. Part of getting started on this is ensuring InfluxDB runs as a service instead of requiring me to launch the exe manually. For more information on InfluxDb, see my other post: <a href="../../running-influx-db-as-a-service-in-windows/">Setting Up InfluxDb, Chronograf, and Grafana for the SqlServer Dev</a></p>
<p>This of course, did not go without it's share of investigation since I'm working with a compiled executable that was originally built in <code>GO</code>. I had issues registering InfluxDB as a service. This is typically due to enviromental/path variables. In my powershell launch of <code>InfluxD.exe</code> I typically used a script like the following:</p>
<script src="https://gist.github.com/sheldonhull/6f4e11d60244af00edac438cb9ae6ea5.js"></script>

<p>I investigated running as a service and found a great reminder on using NSSM for this: <a href="http://bit.ly/2pDW65t">Running Go executables ... as windows services ' Ricard Clau</a> I went and downloaded NSSM again and first setup and register of the service went without a hitch, unlike my attempt at running <code>New-service -name 'InfluxDB' -BinaryPathName 'C:\Influx\influxdb\InfluxD.exe' -DisplayName 'InfluxDB' -StartupType Automatic -Credential (get-credential)</code>. I'm pretty sure the core issue was the <code>PATH</code> variables and other related enviromental paths were not setup with "working directory" being the InfluxDB which would be expected by it.</p>
<h3 id="nssm-non-sucking-service-manager"><a class="toclink" href="../../running-influx-db-as-a-service-in-windows/#nssm-non-sucking-service-manager"><a href="http://bit.ly/2pDTR25">NSSM - Non-Sucking Service Manager</a></a></h3>
<p>Using <code>nssm install</code> provided the GUI which I used in this case. Using the following command I was able to see the steps taken to install, which would allow reproducing the install from a .bat file very easily.</p>
<div class="highlight"><pre><span></span><code>set-location C:\tools
.\nssm.exe dump InfluxDB
</code></pre></div>
<p>This resulted in the following output:</p>
<div class="highlight"><pre><span></span><code>C:\tools\nssm.exe install InfluxDB C:\Influx\influxdb\influxd.exe
C:\tools\nssm.exe set InfluxDB AppDirectory C:\Influx\influxdb
C:\tools\nssm.exe set InfluxDB AppExit Default Restart
C:\tools\nssm.exe set InfluxDB AppEvents Start/Pre C:\Influx\influxdb\influx.exe
C:\tools\nssm.exe set InfluxDB AppEvents Start/Post C:\Influx\influxdb\influx.exe
C:\tools\nssm.exe set InfluxDB AppNoConsole 1
C:\tools\nssm.exe set InfluxDB AppRestartDelay 60000
C:\tools\nssm.exe set InfluxDB DisplayName InfluxDB
C:\tools\nssm.exe set InfluxDB ObjectName SERVICENAME &quot;PASSWORD&quot;
C:\tools\nssm.exe set InfluxDB Start SERVICE_AUTO_START
C:\tools\nssm.exe set InfluxDB Type SERVICE_WIN32_OWN_PROCESS
</code></pre></div>
<p>Pretty awesome! It's a nice change to have something perfectly the first time with no issues.</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-05-17 00:00:00">May 17, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="setting-up-influxdb-chronograf-and-grafana-for-the-sqlserver-dev"><a class="toclink" href="../../setting-up-influx-db-chronograf-and-grafana-for-the-sql-server-dev/">Setting Up InfluxDb, Chronograf, and Grafana for the SqlServer Dev</a></h2>
<p>{{&lt; admonition type="info" title="Updated: 2020-04-29" &gt;}}
broken image links removed
{{&lt; /admonition &gt;}}</p>
<p>There are some beautiful ways to visualize time series data with the tools I'm going to go over. This post is purely focused on the initial setup and saving you some time there. In a future post, I'll show how some of these tools can help you visualize your server performance in a powerful way, including taking metrics from multiple types of servers that be working with SQL Server, and combining the metrics when appropriate to give a full picture of performance.</p>
<p>A beautiful way to visualize performance across a variety of machines</p>
<p>It's pretty epic to combine information across a variety of sources and be able to relate the metrics to the "big picture" that individual machine monitoring might fail to shed light on.</p>
<h3 id="downloading"><a class="toclink" href="../../setting-up-influx-db-chronograf-and-grafana-for-the-sql-server-dev/#downloading">Downloading</a></h3>
<p>I started by running this quick powershell script to download the stable toolkit.</p>
<script src="https://gist.github.com/sheldonhull/5fa33704e2599e3ddb46a8299ad3bafe.js"></script>

<p>Once extracted, I moved the influx extracted subfolder into the InfluxDB folder to keep it clean. Now all the binaries rested in <code>C:\Influx\InfluxDB</code> folder with no nesting folders.
I referenced the documentation for getting started with InfluxDB.</p>
<h3 id="setup-local-influxdb"><a class="toclink" href="../../setting-up-influx-db-chronograf-and-grafana-for-the-sql-server-dev/#setup-local-influxdb">Setup Local InfluxDb</a></h3>
<p>Started up the local influxdb binary.</p>
<script src="https://gist.github.com/sheldonhull/6f4e11d60244af00edac438cb9ae6ea5.js"></script>

<p>Initializing the new database was simple as documented: <code>create database statty</code></p>
<p>{{&lt; admonition type="warning" title="Case Sensitivity" &gt;}}
InfluxDB is case sensitive. Make sure to check your case if something isn't working, such as use "DatabaseName" instead of use "databasename"
{{&lt; /admonition &gt;}}</p>
<p>Also, if you get an error with access to the file, try running as admin.</p>
<h3 id="more-enviromental-variable-fun"><a class="toclink" href="../../setting-up-influx-db-chronograf-and-grafana-for-the-sql-server-dev/#more-enviromental-variable-fun">More Enviromental Variable Fun</a></h3>
<p>A simple fix to errors related to paths and the HOME variable these tools often need, per a Github issue, was to ensure the current path was available as a variable. I did this quickly with a simple batch file to launch the consoles as well as one option, as well as updated the Start-Process script to include a statement to set the env variable for the processes being started. This eliminated the issue. For more details see <a href="http://bit.ly/2nJib1P">github issues</a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">SET</span> <span class="nv">HOME</span><span class="p">=</span><span class="nv">%~dp0</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">start</span> influxd.exe
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">start</span> influx.exe
</code></pre></div>
<p>An additional snippet for launching the console version via a bat file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">set</span> <span class="nv">HOME</span><span class="p">=</span>C:\influx
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>cmd /k influx.exe -host <span class="s2">&quot;MyInfluxDbHost&quot;</span> -database <span class="s2">&quot;statty&quot;</span> -precision <span class="s2">&quot;s&quot;</span> -format column
</code></pre></div>
<h3 id="quick-start-for-telegraf"><a class="toclink" href="../../setting-up-influx-db-chronograf-and-grafana-for-the-sql-server-dev/#quick-start-for-telegraf">Quick Start for Telegraf</a></h3>
<p>Once you have this running you can take the telegraf binaries and run them on any other server to start capturing some default preset metrics. I launched with the following script and placed this in <code>C:\Influx</code> directory to make it easy to access for future runs.</p>
<script src="https://gist.github.com/sheldonhull/1a9641ce607569dde912f996137debae.js"></script>

<p>Edit the conf file to add some tags, change default sampling interval and more. I'll post another article about setting up telegraf to run as a service in the future so search for more info</p>
<p>You can also apply the same bat file in the startup directory such as:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">@</span><span class="c1">REM alternative is using variable</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="p">@</span><span class="c1">REM set TELEGRAF_CONFIG_PATH=C:\telegraf\telegraf.conf</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="k">start</span> <span class="nv">%~dp0</span>telegraf.exe -config <span class="nv">%~dp0</span>telegraf.conf
</code></pre></div>
<h3 id="run-chronograf"><a class="toclink" href="../../setting-up-influx-db-chronograf-and-grafana-for-the-sql-server-dev/#run-chronograf">Run Chronograf</a></h3>
<p>One these metrics began to run, I ran Chronograf. This is Influx's alternative to Grafana, another more mature product.</p>
<script src="https://gist.github.com/sheldonhull/958094675f6ab53897616755dd130144.js"></script>

<p>Upon loading and opening up the instance monitor, I found immediately that I was able to get some metrics from the defaults.</p>
<h3 id="get-grafana"><a class="toclink" href="../../setting-up-influx-db-chronograf-and-grafana-for-the-sql-server-dev/#get-grafana">Get Grafana</a></h3>
<p>My preferred visualization tool, this was far more robust and well documented than Chronograf which has promise, but is a relatively new project.</p>
<p>When starting Grafana, you can run the following script. It creates a copy of the default ini to copy for the user to edit if not already there.</p>
<script src="https://gist.github.com/sheldonhull/3cff34cf9029bd99cd1e888e755c307c.js"></script>

<p>Once you open the localhost page, if you don't see datasources in the left hand drop down, create an organization and ensure you are an admin, you'll then see the option to add datasources. I simple pointed the page to InfluxDB console running on the server I had setup previously.</p>
<h3 id="summary"><a class="toclink" href="../../setting-up-influx-db-chronograf-and-grafana-for-the-sql-server-dev/#summary">summary</a></h3>
<p>This is just a quick guide on getting started as I found a lot of little bumps in the road since the projects are written in <code>GO</code> and not an easily run .NET project. Getting through this will hopefully give you a way to get started. I'll blog a bit more soon on visualization of the metrics captured, some custom annotations to help make metrics come alive with real-time event notifications (like "load test started" and "build ended" etc). It's a really promising solution for those who want some really nice flexibility in using perfmon and related metrics to visualize Windows and SQL Server performance.</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-05-10 00:00:00">May 10, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="automate-windows-updates-for-development"><a class="toclink" href="../../automate-windows-updates-for-development/">Automate Windows Updates for Development</a></h2>
<p>I've run into the case where I wanted updates continually applied, while the machine still was part of the GPO that didn't automatically install updates. For this developer and test oriented machine I wanted every update applied.</p>
<p>I utilized a great module for this and created a script to setup the task and logging to make this an easy task.</p>
<p>If you experience an issue with the WindowsUpdate Vs Microsoft update as the configured update provider, then you can just change the switch in the script for  <code>-MicrosoftUpdate</code> to  <code>-WindowsUpdate</code></p>
<p>This isn't something I'd run in production, but I've found it helpful to updating a development server with the latest SQL Server updates, as well as a development machine, allowing me to keep up with any latest changes with minimal effort.</p>
<p>Change the reboot parameter to your preferred option in the script. I left as <code>autoreboot</code> for the purpose of a low priority dev server being updated.</p>
<script src="https://gist.github.com/sheldonhull/3dc7333846aa93d3f01daaefbcce2898.js"></script>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-05-08 00:00:00">May 8, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="programming-fonts-for-the-newb"><a class="toclink" href="../../programming-fonts-for-the-newb/">Programming Fonts For The Newb</a></h2>
<h3 id="the-camps"><a class="toclink" href="../../programming-fonts-for-the-newb/#the-camps">the camps</a></h3>
<p>Once you get into coding fonts, you'll find that there are two primary camps.</p>
<ol>
<li>Don't give a crap about it. "I'll use defaults for everything and probably wouldn't care if I was coding in Arial". If this is you, then this post is definitely not for you. Please continue to enjoy Comic Sans with my pity. :-)</li>
<li>Font aficionados "Your world will change forever once you use this specific font! It will increase your productivity 300%"</li>
</ol>
<p>Inside the font afficiando realm, you have various subcultures.</p>
<ul>
<li>Fixed Font Only</li>
<li>Elastic Tabstops <a href="http://bit.ly/2GXrrFR">are the future</a>, why can't anyone get with the program? (Elastic tabtop fonts allow proportional fonts with better alignment )</li>
<li>Ligature Fonts changed my world</li>
</ul>
<h3 id="cool-resource"><a class="toclink" href="../../programming-fonts-for-the-newb/#cool-resource">cool resource</a></h3>
<p>One really cool resource for exploring these various types of fonts is <a href="http://bit.ly/2pFIu6P">Programming Fonts - Test Drive</a>. This is a pretty cool resource to preview various fonts and find links and resources for them.</p>
<h3 id="monospaced"><a class="toclink" href="../../programming-fonts-for-the-newb/#monospaced">monospaced</a></h3>
<p>Monospaced fonts ensure that every character take up the same amount of space regardless. This means a period takes up the same space as any other letter of the alphabet.</p>
<p>The goal in recommending this for code editing has to do with the purpose of what's being written and read. In reading your eyes flow over words, and punctuation, while important, supports the words. It doesn't need to take up the same space. In code, every punctuation character is just as important as every single letter written. If you have a bunch of nested formulas for example, reading</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">(</span><span class="s1">&#39;....Total time to process: {0:g}&#39;</span> <span class="o">-f</span> <span class="no">[timespan]</span><span class="p">::</span><span class="n">fromseconds</span><span class="p">(((</span><span class="nb">Get-Date</span><span class="p">)-</span><span class="nv">$StartTime</span><span class="p">).</span><span class="n">Totalseconds</span><span class="p">).</span><span class="n">ToString</span><span class="p">(</span><span class="s1">&#39;hh\:mm\:ss&#39;</span><span class="p">))</span>
</code></pre></div>
<p>becomes harder than ensuring all the punctuation and special characters are easily readable like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">(</span><span class="s1">&#39;....Total time to process: {0:g}&#39;</span> <span class="o">-f</span> <span class="no">[timespan]</span><span class="p">::</span><span class="n">fromseconds</span><span class="p">(((</span><span class="nb">Get-Date</span><span class="p">)-</span><span class="nv">$StartTime</span><span class="p">).</span><span class="n">Totalseconds</span><span class="p">).</span><span class="n">ToString</span><span class="p">(</span><span class="s1">&#39;hh\:mm\:ss&#39;</span><span class="p">))</span>
</code></pre></div>
<p>Visual Studio, SSMS, and other editors by default choose a monospaced font in code editing. However, there are additional options besides the built in fonts.</p>
<h3 id="some-ive-explored"><a class="toclink" href="../../programming-fonts-for-the-newb/#some-ive-explored">some i've explored</a></h3>
<ol>
<li>Bitstream Vera Sans Mono: My go to for a long time. It's aesthetically nice, and has a bit of the Ubuntu styling with some rounder edges.</li>
<li>Fira Code Retina: Very nice with ligature support. This has become my current favorite due to the very nice style with the added perk of the ligatures. That's a nice little typography enhancement that really makes special combinations of characters stand out for readability. This is just a rendering feature that doesn't impact the underlying text per documentation:<blockquote>
<p>This is just a font rendering feature: underlying code remains ASCII-compatible. This helps to read and understand code faster. <a href="https://github.com/tonsky/FiraCode">FiraCode Github</a></p>
</blockquote>
</li>
</ol>
<h3 id="what-to-what-to-look-for"><a class="toclink" href="../../programming-fonts-for-the-newb/#what-to-what-to-look-for">what to what to look for</a></h3>
<p>As you dive into the world of exploring fonts, here's a couple things I'd look for.</p>
<ol>
<li>Characters that can hide problems are easily identified such as a period, or dash, most monospaced fonts are great for this, but some have smaller symbols that might make them a little less readable.</li>
<li>Resizes well for your target zoom. I've tried some fonts that don't seem to look right once you change your zoom level or the size of the font. I looked up some details on this and apparently some fonts are bitmapped, and some vector images. If you are using bitmapped fonts, then the target size is ideal, while adjusting zoom level can cause blurriness or fuzzy quality as it's not going to rescale like a vector based font would. This isn't bad if you are ok with the normal font size levels.</li>
</ol>
<p>{{&lt; fancybox-gallery
    "fontgallery"
"testcaption"
    "fira-code-mono.png"
    "source-code-pro.png"
    "bitstream-vera-sans-mono.png"</p>
<blockquote>
<p>}}</p>
</blockquote>
<p>So far my personal favorite is Fira Code, so check that one out if you are looking for something interesting to try.</p>
<h3 id="resource-links"><a class="toclink" href="../../programming-fonts-for-the-newb/#resource-links">resource links</a></h3>
<p><a href="http://bit.ly/2fpxcSQ">FiraCode Github</a></p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-03-07 00:00:00">March 7, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="tfs-custom-task-service-actions-for-tfs-2015-update-21-or-before"><a class="toclink" href="../../tfs-custom-task-service-actions-%28for-tfs-2015-update-21-or-before%29/">TFS Custom Task - Service Actions (for TFS 2015 Update 2.1 or before)</a></h2>
<p>{{&lt; admonition type="info" title="Updated: 2020-04-29" &gt;}}
broken image links removed
{{&lt; /admonition &gt;}}</p>
<p>Apparently, boolean values for custom VSTS tasks for versions prior to TFS 2015 Update 3) require some special handling as they don't pass the checkbox values as actual powershell <code>$true</code> or <code>$false</code>. Instead the task passes this information along as <code>true</code> or <code>false</code>. To properly handle this you'll need to pass in the value as a <code>string</code> then convert to <code>boolean</code>.</p>
<p>I found a great start on working on this solution in a blog post by Rene which has more detail, so <a href="http://bit.ly/2mggrc9">check it out.</a> In addition, some reading on <a href="http://bit.ly/2mgmMnY">promiscuous types</a> with powershell can be helpful to understand why special handling is needed with conversion.
For example, in the task.json file you'll have:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="w">    </span><span class="nt">&quot;inputs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">            </span><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">                </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MyServiceName*&quot;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">                </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ServiceName&quot;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">                </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ServiceName&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">                </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">                </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">            </span><span class="p">},</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">            </span><span class="p">{</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">                </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">                </span><span class="nt">&quot;helpMarkDown&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;issue restart command&quot;</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">                </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ChangeCredentials&quot;</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">                </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ChangeCredentials&quot;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">                </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">                </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">            </span><span class="p">}</span>
</code></pre></div>
<p>This boolean value provides a checkbox on the custom task window.</p>
<p>To properly work with the boolean value, you have to bring it in as a script then convert it to a boolean value.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>    <span class="k">param</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>             <span class="no">[string]</span><span class="nv">$ServiceName</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>            <span class="p">,</span><span class="no">[string]</span><span class="nv">$ServiceAccount</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>            <span class="p">,</span><span class="no">[string]</span><span class="nv">$RestartService</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>            <span class="p">,</span><span class="no">[string]</span><span class="nv">$StartService</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>            <span class="p">,</span><span class="no">[string]</span><span class="nv">$StopService</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>            <span class="p">,</span><span class="no">[string]</span><span class="nv">$ChangeCredentials</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="p">)</span>
</code></pre></div>
<p>once you have the parameters, use .NET convert functionality to</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="no">[bool]</span><span class="nv">$_RestartService</span>    <span class="p">=</span> <span class="no">[System.Convert]</span><span class="p">::</span><span class="n">ToBoolean</span><span class="p">(</span><span class="nv">$RestartService</span><span class="p">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="no">[bool]</span><span class="nv">$_StartService</span>      <span class="p">=</span> <span class="no">[System.Convert]</span><span class="p">::</span><span class="n">ToBoolean</span><span class="p">(</span><span class="nv">$StartService</span><span class="p">)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="no">[bool]</span><span class="nv">$_StopService</span>       <span class="p">=</span> <span class="no">[System.Convert]</span><span class="p">::</span><span class="n">ToBoolean</span><span class="p">(</span><span class="nv">$StopService</span><span class="p">)</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="no">[bool]</span><span class="nv">$_ChangeCredentials</span> <span class="p">=</span> <span class="no">[System.Convert]</span><span class="p">::</span><span class="n">ToBoolean</span><span class="p">(</span><span class="nv">$ChangeCredentials</span><span class="p">)</span>
</code></pre></div>
<p>Below I've included a custom TFS Task for basic start/stop/restart/change credentials with a custom tfs task. It's not super refined, but it's a good start to get you on your way.</p>
<script src="https://gist.github.com/sheldonhull/622ee7b3da8423b689c9a266816103aa.js"></script>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-02-27 00:00:00">February 27, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="red-gate-sql-clone-1-initial-setup"><a class="toclink" href="../../red-gate-sql-clone-1-initial-setup/">Red Gate SQL Clone (1) - Initial Setup</a></h2>
<p>Note this was during earlier beta usage, so some of the UI and other features will have been updated more. I plan on writing more on this promising tool as  I get a chance to dive into it more, especially the powershell cmdlets for database cloning automation. In the meantime, I believe the permissions issue is still relevant, so I'll post this as a reminder in case someone is working through the initial setup.</p>
<p>It seems like a real promising toolkit for testing and reducing storage requirements for testing database automated deployment pipelines.</p>
<p><img alt="Clone Setup Getting Started" src="../../2017/images/2016-08-15_10-19-34.png" /></p>
<p><img alt="Clone Setup Creating Clone" src="../../2017/images/2016-08-15_10-11-17.png" /></p>
<p><img alt="Add to local admin on machine" src="../../2017/images/2016-08-15_10-19-04.png" /></p>
<h3 id="error-starting-service"><a class="toclink" href="../../red-gate-sql-clone-1-initial-setup/#error-starting-service">Error starting service</a></h3>
<blockquote>
<p>The Redgate SQL Clone service on Local Computer started and then stopped. Some services stop automatically if they are not in use by other services or programs.</p>
</blockquote>
<p>I wasn't using for a while due to error message I couldn't figure out. I then read through the help documentation again and found that the permissions required for the service account should be a <strong>local admin</strong>. Once I added the service account to local admins, it correctly allowed the service to start.</p>
<p><img alt="Error if you don" src="../../2017/images/2016-08-15_10-17-17.png" /></p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-02-24 00:00:00">February 24, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="life-hack-when-you-need-a-mouse-pad"><a class="toclink" href="../../life-hack-when-you-need-a-mouse-pad/">Life Hack: When you need a mouse pad</a></h2>
<p>My Logitech Master mouse went on the fritz... Requiring me to use my trusty Microsoft mouse. This is an optical based mouse based mouse that started driving me insane with the lack of precision. This exhibited random skips and overall lack of agreeability. I ran across some posts mentioning optical mice have issues with certain surfaces making it hard to detect precise movements and suggested using a surface with a pattern or irregularity, even a piece of paper being scribbled on. I was using a white desk, very little pattern to work with. The MX Master worked perfectly, but it had spoiled me.</p>
<p>After searching the office and failing to find a usable mousepad (seriously!)... I googled diy mousepad.</p>
<p>Lo and beheld, a fantastic website provided the <a href="http://bit.ly/2lhDkuA">World's original cheapest Mousepad</a>. Well worth visiting despite its self disparaging remarks. Thank you for your contribution to the Internet's vast amalgamation of priceless documents.</p>
<p>After feeling like an idiot, I printed, taped to my desk and the magical precision returned. Life hack!</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-02-18 00:00:00">February 18, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="implicit-transactions"><a class="toclink" href="../../implicit-transactions/">Implicit Transactions</a></h2>
<p>Never messed around with this setting in the server configuration, so I was unfamilar with the impact it would have.If I ran a statement with something like the following:</p>
<div class="highlight"><pre><span></span><code>insert into foo
select bar
insert into foo
select bar
</code></pre></div>
<p>I know that if the first had an aborting error, such as text was too long, the second statement would not complete as the batch would have failed.
If you instead did</p>
<div class="highlight"><pre><span></span><code>insert into foo
select bar
GO
insert into foo
select bar
</code></pre></div>
<p>and had the same error, the second would be completed, since the first would throw an error, but the GO separates the second statement explicitly into another batch, and therefore another transaction.
Interestingly, the <code>Implicit Transactions</code> option changes the behavior to making each statement act as if it was encapsulated by <code>begin transaction --- commit transaction</code> instead of requiring this to be defined.
So if you set <code>implicit transactions</code> on and ran the statement below with no go statement:</p>
<div class="highlight"><pre><span></span><code>insert into foo
select bar
insert into foo
select bar
</code></pre></div>
<p>It is really operating as if:</p>
<div class="highlight"><pre><span></span><code>begin transaction
insert into foo
select bar
commit transaction
GO
begin transaction
insert into foo
select bar
commit transaction
</code></pre></div>
<p><a href="http://bit.ly/1U0362O">MSDN - Implicit Conversions</a> is a resource that further documents the behavior, indicating that a rollback for the particular transaction is handled automatically. This means that since that each statement is treated as a transaction that it will not abort the second statement and terminate execution if the first experinces the error, since by "implicit conversions" this would be handled separately.
MSDN article with example code to walk through it
<a href="https://technet.microsoft.com/en-us/library/ms190230(v=sql.105).aspx">https://technet.microsoft.com/en-us/library/ms190230(v=sql.105).aspx</a></p>
<div class="highlight"><pre><span></span><code>/*******************************************************
STEP 1: SETUP
*******************************************************/
use tempdb;
set nocount on;
set xact_abort off;
set implicit_transactions off;
if object_id(&#39;dbo.TestImplicitTrans&#39;,&#39;U&#39;) is not null
begin
print &#39;Dropped dbo.TestImplicitTrans per existed&#39;;
drop table dbo.TestImplicitTrans;
end;
print &#39;create table dbo.TestImplicitTrans&#39;;
create table dbo.TestImplicitTrans
(
test_k int primary key
identity(1,1)
not null
,random_text varchar(5) not null
);
go
/*******************************************************
TEST 1:
xact_abort off
set implicit_transactions off
Results in:
- first transaction fails
- second transaction succeeds (this is due to xact_abort off not being activated)
test_k  random_text
2           12345
*******************************************************/
use tempdb;
go
set nocount on;
set xact_abort off;
set implicit_transactions off;
truncate table dbo.TestImplicitTrans;
print &#39;Statement 1 START&#39;;
insert into dbo.TestImplicitTrans (random_text) values (&#39;00001x&#39;);
print &#39;Current trancount: &#39; + cast(@@trancount as varchar(100));
insert into dbo.TestImplicitTrans (random_text) values (&#39;00002&#39;);
print &#39;Current trancount: &#39; + cast(@@trancount as varchar(100));
insert into dbo.TestImplicitTrans (random_text) values (&#39;00003&#39;);
print &#39;Successfully inserted: &#39; + cast(@@rowcount as varchar(10));
print &#39;Statement 1 END&#39;;
print char(13) + char(13) + &#39;Statement 2 START&#39;;
insert  into dbo.TestImplicitTrans
(random_text)
values
(&#39;12345&#39;  -- random_text - varchar(5)
);
print &#39;Successfully inserted: &#39; + cast(@@rowcount as varchar(10));
print &#39;Statement 2 END&#39;;
select
*
from
dbo.TestImplicitTrans as TIT;
go
/*******************************************************
TEST 2:
xact_abort on
set implicit_transactions off
Results in:
- first transaction fails
- second transaction doesn&#39;t execute due to xact abort being set on
test_k  random_text
NONE
*******************************************************/
use tempdb;
go
set nocount on;
set xact_abort on;
set implicit_transactions off;
truncate table dbo.TestImplicitTrans;
print &#39;Statement 1 START&#39;;
insert  into dbo.TestImplicitTrans
(random_text)
values
(&#39;12345x&#39;  -- random_text - varchar(5)  ONE CHARACTER TOO LARGE
);
print &#39;Successfully inserted: &#39; + cast(@@rowcount as varchar(10));
print &#39;Statement 1 END&#39;;
print char(13) + char(13) + &#39;Statement 2 START&#39;;
insert  into dbo.TestImplicitTrans
(random_text)
values
(&#39;12345&#39;  -- random_text - varchar(5)
);
print &#39;Successfully inserted: &#39; + cast(@@rowcount as varchar(10));
print &#39;Statement 2 END&#39;;
select
*
from
dbo.TestImplicitTrans as TIT;
go
/*******************************************************
TEST 2:
xact_abort off
set implicit_transactions off
Results in:
- first transaction fails
- second transaction doesn&#39;t execute due to xact abort being set on
test_k  random_text
NONE
*******************************************************/
use tempdb;
go
set nocount on;
set xact_abort on;
set implicit_transactions on;
truncate table dbo.TestImplicitTrans;
print &#39;Statement 1 START&#39;;
insert  into dbo.TestImplicitTrans
(random_text)
values
(&#39;12345x&#39;  -- random_text - varchar(5)  ONE CHARACTER TOO LARGE
);
print &#39;Successfully inserted: &#39; + cast(@@rowcount as varchar(10));
print &#39;Statement 1 END&#39;;
print char(13) + char(13) + &#39;Statement 2 START&#39;;
insert  into dbo.TestImplicitTrans
(random_text)
values
(&#39;12345&#39;  -- random_text - varchar(5)
);
print &#39;Successfully inserted: &#39; + cast(@@rowcount as varchar(10));
print &#39;Statement 2 END&#39;;
select
*
from
dbo.TestImplicitTrans as TIT;
go
</code></pre></div>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2017-02-18 00:00:00">February 18, 2017</time></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="quick-way-to-run-powershell-tasks-in-parallel"><a class="toclink" href="../../quick-way-to-run-powershell-tasks-in-parallel/">Quick Way to Run Powershell Tasks in Parallel</a></h2>
<p>Running tasks in parallel can be a bit difficult in powershell. However, there are a few projects out there that optimize the performance and provide a better experience of running tasks in parallel with less effort.#cool uses
A few cool uses of this might be running parallel sql queries across multiple servers or databases while maintaining a throttled limit to avoid saturation of the target environment. Additionally, long running queries might benefit in running in parallel if running on multiple objects in the same database or in different databases.</p>
<h2 id="module-magic"><a class="toclink" href="../../quick-way-to-run-powershell-tasks-in-parallel/#module-magic">module magic</a></h2>
<p>I've utilized two main modules to advance this.
<a href="https://github.com/powercode/PSParallel">PSParallel</a> and <a href="https://github.com/proxb/PoshRSJob/">PoshRSJobs</a>. Both are fantastic options. The Invoke-Parallel is not steadily maintained, so I try to use PoshRSJob when possible. However, for ease of use the Invoke-Parallel option is pretty awesome as it automatically imports variables, functions, and modules into the block to allow for less work in defining parameters, having to use the <code>$using:variablename</code> clause, etc.</p>
<h2 id="lots-of-gotchas"><a class="toclink" href="../../quick-way-to-run-powershell-tasks-in-parallel/#lots-of-gotchas">lots of gotchas</a></h2>
<p>However, be prepared to deal with some complications in doing this with powershell. For instance, write-host, write-verbose, write-error, at this time can throw errors in PoshRSJob or not provide any output, as these streams are not incorporated the same as your local ISE session. In fact, at the time of this post, for output to stream from the PoshRSJob module, I had to change my output from:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">write-host</span> <span class="s1">&#39;I know a kitten dies every time writehost is used, but I just cannot stop myself&#39;</span>
</code></pre></div>
<p>to</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="s2">&quot;I know a kitten dies every time writehost is used, but I just cannot stop myself&quot;</span>
</code></pre></div>
<p>Yes... no write-host/write-error/write-verbose is used here, just quotes for it. The developer and github community is looking to improve this, but at this time, don't expect logging or error messages to come through the same way.</p>
<p>Be prepared to deal with some complications on error handling when dealing with runspaces, as even though they are more performant, there is a lot of issues with scope to deal with in those isolated runspaces. Once you start increasing the size of the script blocks things can get hard to debug.</p>
<p><strong>I think the simpler the task to pass into the parallel tasks, the better.</strong></p>
<p>However, for some basic tasks that would benefit in parallel, you can definitely give it a shot.
This task focused on iterating through a directory recursively and cleaning up each of the files by stripping out comments and blank lines. The following results were a simple example and interesting to compare.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>    -------- Summary with PoshRSJobs--------
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    File Size:   9.59 MB
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    Total Count: 4,600.00
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    Filepath: C:\temp\MyCleanedUpZip.zip
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    Total Original Lines: 1221673
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    Total Lines: 1,201,746.00
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    Total Lines Saved:  21,959.00
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    TOTAL TIME TO RUN: 08:43
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    -------- Summary with Invoke-Parallel --------
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    File Size:   6.69 MB
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>    Total Count: 4,447.00
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    Filepath: C:\temp\MyCleanedUpZip.zip
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    Total Original Lines: 1221436
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    Total Lines: 854,375.00
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    Total Lines Saved:  360,045.00
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    TOTAL TIME TO RUN: 05:22
</code></pre></div>
<p>PoshRSJobs seemed to approach creating the job list first, which took a long time, and then processed the output very quickly. Overall, this took longer for this type of task. Invoke-Parallel gave an almost instant response showing the progress bar with estimated time remaining, so for this type of job it actually ran faster.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>    -------- Summary - Native ForEach --------
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    File Size:   6.69 MB
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    Total Count: 4,621.00
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    Filepath: C:\temp\MyCleanedUpZip.zip
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    Total Original Lines: 1227408
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    Total Lines: 861,600.00
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    Total Lines Saved:  365,808.00
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    TOTAL TIME TO RUN: 04:52
</code></pre></div>
<p>Surprising to me, the native foreach which was single threaded was faster. I believe in this case, the overhead of setting up the jobs was not worth parallel task processing. Since the task was a lot of small tasks, this probably wasn't a good candidate for parallel tasks. Based on this small test case, I'd venture to look into parallel tasks when longer run times are involved, such as perhaps copying large files that aren't oversaturating your IO. In this case, slow long copies would probably benefit from parallel tasks, while small text file copies as I showed wouldn't.
A simple example of the difference in syntax for using PSParallel would be just counting lines in files in a directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nv">$Folder</span> <span class="p">=</span> <span class="s1">&#39;C:\Temp&#39;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nv">$startTime</span> <span class="p">=</span> <span class="nb">get-date</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="no">[int]</span><span class="nv">$TotalManualCount</span> <span class="p">=</span> <span class="n">0</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="nv">$Folder</span> <span class="n">-Recurse</span> <span class="n">-Force</span> <span class="s1">&#39; where { ! $_.PSIsContainer } &#39;</span> <span class="p">%</span> <span class="p">{</span> <span class="nv">$TotalManualCount</span> <span class="p">+=</span> <span class="p">(</span><span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="p">(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span> <span class="n">-Force</span> <span class="s1">&#39; Measure-Object -Line).Lines}</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="s1">write-host (&#39;</span><span class="n">Total</span> <span class="n">Lines</span><span class="p">:</span> <span class="p">{</span><span class="n">0</span><span class="p">:</span><span class="n">N2</span><span class="p">}</span><span class="s1">&#39; -f $TotalManualCount)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="s1">Write-host (&#39;</span><span class="k">FOREACH</span><span class="p">:</span> <span class="n">Total</span> <span class="n">time</span> <span class="n">to</span> <span class="k">process</span><span class="p">:</span> <span class="p">{</span><span class="n">0</span><span class="p">}</span><span class="s1">&#39; -f [timespan]::fromseconds(((Get-Date)-$StartTime).Totalseconds).ToString(&#39;</span><span class="n">mm</span><span class="p">\:</span><span class="n">ss</span><span class="s1">&#39;))</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="s1">#Using Invoke-Parallel#</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="s1">$ManualCount = [hashtable]::Synchronized(@{})</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="s1">$ManualCount = @{</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="s1">TotalCount     = 0</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="s1">}</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="s1">$Folder = &#39;</span><span class="n">C</span><span class="p">:\</span><span class="n">Temp</span><span class="s1">&#39;</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="s1">$startTime = get-date</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="s1">Get-ChildItem -Path $Folder -Recurse -Force &#39;</span> <span class="nb">where </span><span class="p">{</span> <span class="p">!</span> <span class="nv">$_</span><span class="p">.</span><span class="n">PSIsContainer</span> <span class="p">}</span> <span class="s1">&#39; Start-RsJob -Throttle 4 -ArgumentList $ManualCount -ScriptBlock {</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="s1">[cmdletbinding()]</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="s1">param($ManualCount)</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="s1">$ManualCount.TotalCount += (Get-Content -Path ($_.FullName) -Force &#39;</span> <span class="nb">Measure-Object</span> <span class="n">-Line</span><span class="p">).</span><span class="n">Lines</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="p">}</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="nb">write-host</span> <span class="p">(</span><span class="s1">&#39;Total Lines: {0:N2}&#39;</span> <span class="o">-f</span> <span class="nv">$ManualCount</span><span class="p">.</span><span class="n">TotalCount</span><span class="p">)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="nb">Write-host</span> <span class="p">(</span><span class="s1">&#39;INVOKE-PARALLEL: Total time to process: {0}&#39;</span> <span class="o">-f</span> <span class="no">[timespan]</span><span class="p">::</span><span class="n">fromseconds</span><span class="p">(((</span><span class="nb">Get-Date</span><span class="p">)-</span><span class="nv">$StartTime</span><span class="p">).</span><span class="n">Totalseconds</span><span class="p">).</span><span class="n">ToString</span><span class="p">(</span><span class="s1">&#39;mm\:ss&#39;</span><span class="p">))</span>
</code></pre></div>
<p>Note that this simple code example might have had some issues with counts due to locking with the synchronized hash table usage. Based on a few searches, it looks like you need to implement a lock on the hash table which ensures that particular thread is able to safely update. I didn't find clear proof that the synchronized hash table was working or failing, but it's something to be aware of. There are some active efforts on improving in PoshRSJob github issues.
Hopefully you'll have a few new ideas on working with Parallel tasks in powershell now, and think about leveraging it for some tedious tasks that might benefit with SQL server or other administrative jobs.</p>
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../..">1</a> <span class="md-pagination__dots">..</span> <a class="md-pagination__link" href="../24/">24</a> <a class="md-pagination__link" href="../25/">25</a> <span class="md-pagination__current">26</span> <a class="md-pagination__link" href="../27/">27</a> <a class="md-pagination__link" href="../28/">28</a> <span class="md-pagination__dots">..</span> <a class="md-pagination__link" href="../37/">37</a>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.follow", "navigation.top", "navigation.path", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.4.0/dist/mermaid.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>