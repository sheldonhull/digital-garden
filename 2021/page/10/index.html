
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../2022/">
      
      
        <link rel="next" href="../../../2020/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>2021 - digital garden</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/gist.css">
    
      <link rel="stylesheet" href="../../../stylesheets/code-highlighting.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2021" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="digital garden" class="md-header__button md-logo" aria-label="digital garden" data-md-component="logo">
      
  <img src="../../../assets/images/sheldon-avatar.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            digital garden
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2021
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sheldonhull/digital-garden" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../welcome/" class="md-tabs__link">
        
  
    
  
  home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  posts

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../development/tooling/task/" class="md-tabs__link">
          
  
    
  
  notes

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../2023/" class="md-tabs__link">
          
  
    
  
  archive

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="digital garden" class="md-nav__button md-logo" aria-label="digital garden" data-md-component="logo">
      
  <img src="../../../assets/images/sheldon-avatar.jpg" alt="logo">

    </a>
    digital garden
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sheldonhull/digital-garden" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../welcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    posts
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../development/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Development
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../development/tooling/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tooling
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            Tooling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/tooling/task/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    task
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/tooling/precommit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    precommit
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/tooling/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/tooling/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/tooling/direnv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    direnv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/tooling/aqua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aqua
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../development/shell/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Shell
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Shell
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/shell/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../development/powershell/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Powershell
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            Powershell
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/powershell/powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    powershell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/powershell/pester/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pester
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/powershell/dbatools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dbatools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/observability/observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    observability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/level-up/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level-Up
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/kubernetes/kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kubernetes
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../development/go/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Go
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_8" id="__nav_3_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_8">
            <span class="md-nav__icon md-icon"></span>
            Go
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/vscode-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VSCode Configuration for Go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/using-go-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Go Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/pre-commit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre-Commit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/mage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go Logging
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/goroutines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    goroutines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/effective-go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Effective Go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/dagger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dagger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/go/code-coverage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Coverage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../development/front-end/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Front end
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_9" id="__nav_3_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_9">
            <span class="md-nav__icon md-icon"></span>
            Front end
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/front-end/yarn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Yarn
  </span>
  

      </a>
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../development/build-release-engineering/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Build release engineering
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_10" id="__nav_3_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_10">
            <span class="md-nav__icon md-icon"></span>
            Build release engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/build-release-engineering/renovate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    renovate
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/build-release-engineering/azure-pipelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Pipelines
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../development/aws/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Aws
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_11" id="__nav_3_1_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_11">
            <span class="md-nav__icon md-icon"></span>
            Aws
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/aws/s5cmd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syncing Files Using S5Cmd
  </span>
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/aws/aws-powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS PowerShell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/aws/aws-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-cli
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../development/ai/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Ai
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_12" id="__nav_3_1_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_12">
            <span class="md-nav__icon md-icon"></span>
            Ai
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/ai/copilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    copilot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/ai/chat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chat
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Career
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Career
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../career/management-dynamics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Management Dynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../career/eponymous-laws/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Eponymous Laws
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../career/engineering-culture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Engineering Culture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../career/communication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Communication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    2021
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="../../" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#azure-pipelines-template-iteration" class="md-nav__link">
    <span class="md-ellipsis">
      Azure Pipelines Template Iteration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#git-workflow-with-git-town" class="md-nav__link">
    <span class="md-ellipsis">
      Git Workflow With Git Town
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#go-r1-day-28" class="md-nav__link">
    <span class="md-ellipsis">
      Go R1 Day 28
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#incremental-and-consistent" class="md-nav__link">
    <span class="md-ellipsis">
      Incremental and Consistent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-powershell-objects-to-create-yaml" class="md-nav__link">
    <span class="md-ellipsis">
      Working With Powershell Objects to Create Yaml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nativefier" class="md-nav__link">
    <span class="md-ellipsis">
      Nativefier
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#go-r1-day-27" class="md-nav__link">
    <span class="md-ellipsis">
      Go R1 Day 27
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-pages-now-supports-private-pages" class="md-nav__link">
    <span class="md-ellipsis">
      Github Pages Now Supports Private Pages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ensuring-profile-environment-variables-available-to-intellij" class="md-nav__link">
    <span class="md-ellipsis">
      Ensuring Profile Environment Variables Available to Intellij
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-an-s3-lifecycle-policy-with-powershell" class="md-nav__link">
    <span class="md-ellipsis">
      Create an S3 Lifecycle Policy with PowerShell
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2017
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2016/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2016
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2015/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2015
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2014/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2014
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2013/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2013
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#azure-pipelines-template-iteration" class="md-nav__link">
    <span class="md-ellipsis">
      Azure Pipelines Template Iteration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#git-workflow-with-git-town" class="md-nav__link">
    <span class="md-ellipsis">
      Git Workflow With Git Town
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#go-r1-day-28" class="md-nav__link">
    <span class="md-ellipsis">
      Go R1 Day 28
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#incremental-and-consistent" class="md-nav__link">
    <span class="md-ellipsis">
      Incremental and Consistent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-powershell-objects-to-create-yaml" class="md-nav__link">
    <span class="md-ellipsis">
      Working With Powershell Objects to Create Yaml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nativefier" class="md-nav__link">
    <span class="md-ellipsis">
      Nativefier
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#go-r1-day-27" class="md-nav__link">
    <span class="md-ellipsis">
      Go R1 Day 27
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-pages-now-supports-private-pages" class="md-nav__link">
    <span class="md-ellipsis">
      Github Pages Now Supports Private Pages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ensuring-profile-environment-variables-available-to-intellij" class="md-nav__link">
    <span class="md-ellipsis">
      Ensuring Profile Environment Variables Available to Intellij
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-an-s3-lifecycle-policy-with-powershell" class="md-nav__link">
    <span class="md-ellipsis">
      Create an S3 Lifecycle Policy with PowerShell
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="2021">2021<a class="headerlink" href="#2021" title="Permanent link">ðŸ”—</a></h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-03-05 00:00:00">March 5, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="azure-pipelines-template-iteration"><a class="toclink" href="../../../azure-pipelines-template-iteration/">Azure Pipelines Template Iteration</a></h2>
<h3 id="templates"><a class="toclink" href="../../../azure-pipelines-template-iteration/#templates">Templates</a></h3>
<p>This isn't meant to be an exhaustive template overview.
I'm just going to give an example of what I found useful as I've been meaning to leverage templates for a while and finally got around to having a great use for it.</p>
<h3 id="my-use-case"><a class="toclink" href="../../../azure-pipelines-template-iteration/#my-use-case">My Use Case</a></h3>
<p>I am a heavy user of <a href="https://bit.ly/3be6EP8">InvokeBuild</a>.
It's a very robust task runner tool that I've used to coordinate many project oriented actions, similar to Make, but also DevOps oriented work like AWS SSM tasks and more.</p>
<p>In this scenario, I needed to run a query across: multiple queries -&gt; across multiple servers -&gt; across hundreds of databases --&gt; and finally produce a single jsonl artifact<sup id="fnref2:json-lines"><a class="footnote-ref" href="../../../azure-pipelines-template-iteration/#fn:json-lines">3</a></sup></p>
<p>Originally, I did this in a single Invoke-Build task, but what I discovered was with a long running job I wanted to have a bit more granular view of the progress and percentage complete.
This also helped me visualize a bit more what specific queries cost the most in time.</p>
<h3 id="azure-pipeline-construction"><a class="toclink" href="../../../azure-pipelines-template-iteration/#azure-pipeline-construction">Azure Pipeline Construction</a></h3>
<p>I've extracted out the key essential pieces here to explain the core concepts.</p>
<h4 id="build-number"><a class="toclink" href="../../../azure-pipelines-template-iteration/#build-number">Build Number</a></h4>
<p>Build name is dynamically generated.
This is my standard format for most pipelines, but you can adjust the naming with parameters (which are a compile time, before runtime) as well to add other descriptive values.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(BuildDefinitionName).$(Configuration).$(Build.QueuedBy).$(DayOfYear)$(Rev:.r)</span>
</code></pre></div>
<p>{{&lt; admonition type="Info" title="Parameters" open="false"&gt;}}</p>
<p>Parameters are evaluated at compile time, rather than during the build run phase.</p>
<p>This means you can use something like the example below to update the queued build name on run.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(BuildDefinitionName).$(Configuration).$(Build.QueuedBy).${{ parameters.SELECTED_VALUE }}.$(DayOfYear)$(Rev:.r)</span>
</code></pre></div>
<p>Using a build variable might require updating the build name if the build variable isn't set on queue, as it won't pick it up without this command.</p>
<p>{{&lt; /admonition &gt;}}</p>
<h4 id="trigger"><a class="toclink" href="../../../azure-pipelines-template-iteration/#trigger">Trigger</a></h4>
<p>Setting the following values ensures this is a manual pipeline.
Otherwise, once the pipeline is linked it would automatically trigger on PR and main branch commits.</p>
<p>There's other customization in terms of filtering triggers based on the path of the changed file, branch names, batching changes with multiple commits, and more in the docs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>trigger: none
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>pr: none
</code></pre></div>
<h4 id="parameters"><a class="toclink" href="../../../azure-pipelines-template-iteration/#parameters">Parameters</a></h4>
<p>Designed for user input, the parameters provide a good experience in customizing runs easily at queue time.</p>
<p>This can be a full yaml defined object, but my examples here are the simple ones.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nt">parameters</span><span class="p">:</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Configuration</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">qa</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="nt">values</span><span class="p">:</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">qa</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">QUERY_NAME</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;no-override&#39;</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">If no-override, then run everything, else specify a specific query to run.</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SERVER_LIST</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;tcp:123.123.123.1;tcp:123.123.123.2&#39;</span><span class="w"> </span><span class="c1">#split this in the task code</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Example Input that InvokeBuild would split to array</span>
</code></pre></div>
<h4 id="variables"><a class="toclink" href="../../../azure-pipelines-template-iteration/#variables">Variables</a></h4>
<p>Parameters won't be set in the environment variables, so if you want these exposed to the next tasks, you have to set the variable from the parameter.</p>
<p>This command will now mean the tasks run will have a <code>$ENV:CONFIGURATION</code> set automatically.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nt">variables</span><span class="p">:</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CONFIGURATION</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.Configuration }}</span>
</code></pre></div>
<h4 id="job"><a class="toclink" href="../../../azure-pipelines-template-iteration/#job">Job</a></h4>
<p>The pipelines allow you to only put the level of complexity you need in your runbook.</p>
<p>This means if you just have tasks, you can put those, but if you have a deployment job then you can include tasks in the appropriate child section.</p>
<p>For my default template here I like control of multi-stage yaml builds, so I use the following format.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nt">jobs</span><span class="p">:</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">deployment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-query-runbook</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Query in ${{ parameters.Configuration }}</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="nt">timeoutInMinutes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">480</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="nt">continueOnError</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;my-environment-${{</span><span class="nv"> </span><span class="s">parameters.Configuration</span><span class="nv"> </span><span class="s">}}&#39;</span><span class="w">  </span><span class="c1">#could setup approval requirements for environments by specifying a name like `my-environment-prod` requires manual approval or is limited to specific folks</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">    </span><span class="nt">pool</span><span class="p">:</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-own-internal-agent</span><span class="w">  </span><span class="c1"># OR use hosted container config if you want</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">      </span><span class="nt">demands</span><span class="p">:</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agent.os -equals Windows_NT</span><span class="w">  </span><span class="c1"># OR use Ubuntu if you have linux container. This is customizable to help you filter to desired agent if working with private subnets etc.</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">env -equals ${{ parameters.Configuration }}</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="w">    </span><span class="nt">strategy</span><span class="p">:</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">      </span><span class="nt">runOnce</span><span class="p">:</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">        </span><span class="nt">deploy</span><span class="p">:</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">          </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">checkout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">self</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="w">              </span><span class="nt">persistCredentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="w">              </span><span class="nt">fetchDepth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">  </span><span class="c1"># Unlimited in case you need more history</span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="w">              </span><span class="nt">clean</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">printAllVariables@1</span>
</code></pre></div>
<h4 id="using-the-template"><a class="toclink" href="../../../azure-pipelines-template-iteration/#using-the-template">Using the Template</a></h4>
<p>At the same level as the task, the template can be called.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">templates/run-query.yml</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">              </span><span class="nt">parameters</span><span class="p">:</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">                </span><span class="nt">SERVER_LIST</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.QUERY_NAME}}</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">                </span><span class="l l-Scalar l-Scalar-Plain">${{ if ne(parameters.QUERY_NAME,&#39;no-override&#39;) }}</span><span class="p p-Indicator">:</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">                  </span><span class="nt">querynames</span><span class="p">:</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;${{</span><span class="nv"> </span><span class="s">parameters.QUERY_NAME</span><span class="nv"> </span><span class="s">}}&#39;</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">                </span><span class="l l-Scalar l-Scalar-Plain">${{ if eq(parameters.QUERY_NAME,&#39;no-override&#39;) }}</span><span class="p p-Indicator">:</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="w">                  </span><span class="nt">querynames</span><span class="p">:</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Query1&#39;</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Query2&#39;</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Query3&#39;</span>
</code></pre></div>
<p>A few concepts to unpack:</p>
<ul>
<li>Parameters must be passed into the template, as any build variables automatically in scope.</li>
<li>Variable reuse <sup id="fnref2:variable-reuse"><a class="footnote-ref" href="../../../azure-pipelines-template-iteration/#fn:variable-reuse">6</a></sup> has it's own set of quirks with templates.</li>
</ul>
<blockquote>
<p>Within a template expression, you have access to the parameters context that contains the values of parameters passed in. Additionally, you have access to the variables context that contains all the variables specified in the YAML file plus many of the predefined variables (noted on each variable in that topic). Importantly, it doesn't have runtime variables such as those stored on the pipeline or given when you start a run. Template expansion happens very early in the run, so those variables aren't available. <sup id="fnref2:template-context"><a class="footnote-ref" href="../../../azure-pipelines-template-iteration/#fn:template-context">4</a></sup></p>
</blockquote>
<ul>
<li>Expressions allow some conditional evaluation and change in behavior of the pipeline.<sup id="fnref4:expressions"><a class="footnote-ref" href="../../../azure-pipelines-template-iteration/#fn:expressions">5</a></sup></li>
</ul>
<h4 id="template-structure"><a class="toclink" href="../../../azure-pipelines-template-iteration/#template-structure">Template Structure</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nt">parameters</span><span class="p">:</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;QUERY_NAME&#39;</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;CONFIGURATION&#39;</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;SERVER_LIST&#39;</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
</code></pre></div>
<p>Now that we have the parameters defined, we can use a steps block and loop on the <code>QUERY_NAME</code> parameter that could be a single or multiple entry input.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ each query in parameters.QUERY_NAME }}</span><span class="p p-Indicator">:</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PowerShell@2</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">        </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Query ${{ query }}</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">        </span><span class="nt">inputs</span><span class="p">:</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">          </span><span class="nt">targetType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inline</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">          </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">            </span><span class="no">&amp;./build.ps1 -Tasks &#39;run-my-query&#39; -Configuration &#39;${{ parameters.CONFIGURATION }}&#39; -QueryName &#39;${{ query }}&#39;</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">          </span><span class="nt">errorActionPreference</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Stop&#39;</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">          </span><span class="nt">pwsh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">          </span><span class="nt">failOnStderr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">          </span><span class="nt">workingDirectory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(Build.SourcesDirectory)</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">          </span><span class="nt">OPTIONAL_ENV_VARS</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ parameters.EXAMPLE }}</span>
</code></pre></div>
<p>This could also be slightly altered if you don't want inline scripts to use the following.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nt">filePath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build.ps1</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="nt">argumentList</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;-Tasks</span><span class="nv"> </span><span class="s">&#39;run-my-query&#39;</span><span class="nv"> </span><span class="s">-Configuration</span><span class="nv"> </span><span class="s">&#39;${{</span><span class="nv"> </span><span class="s">parameters.CONFIGURATION</span><span class="nv"> </span><span class="s">}}&#39;</span><span class="nv"> </span><span class="s">-QueryName</span><span class="nv"> </span><span class="s">&#39;${{</span><span class="nv"> </span><span class="s">query</span><span class="nv"> </span><span class="s">}}&#39;&quot;</span>
</code></pre></div>
<h3 id="reporting-progress"><a class="toclink" href="../../../azure-pipelines-template-iteration/#reporting-progress">Reporting Progress</a></h3>
<p>As the task runs, you can output percent complete so that your task shows how far along it is.
I find this great for long running tasks, helping me check on them and know it's not stuck.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="l l-Scalar l-Scalar-Plain">Write-Host &quot;##vso[task.setprogress value=$PercentComplete;]MyTask&quot;</span>
</code></pre></div>
<h3 id="final-result"><a class="toclink" href="../../../azure-pipelines-template-iteration/#final-result">Final Result</a></h3>
<p>This allows the job to set dynamically the individual tasks to run, report progress on each, and log the timing.</p>
<p>While it could be run as a single task, I prefer this type of approach because a long running job is now much more easily tracked as it progresses.</p>
<p><img alt="image-of-individual-tasks-in-pipeline" src="../../images/2021-03-04-13.38.45-pipelines-example.png" /></p>
<h3 id="further-features"><a class="toclink" href="../../../azure-pipelines-template-iteration/#further-features">Further Features</a></h3>
<p>Templates allow for a wide range of usage and flexibility that I've barely touched.
Selecting entire sets of tasks at runtime, variable sets, and more are all available.</p>
<p>This was a first round usage of them, as I really want to leverage the potentional for DRY with pipelines more, and templates offer a really flexible option to reusing core code across multiple pipelines without having to version each individually and try to keep them up to date.</p>
<h3 id="more-resources"><a class="toclink" href="../../../azure-pipelines-template-iteration/#more-resources">More Resources</a></h3>
<ul>
<li><a href="https://bit.ly/3ruO5vT">Azure DevOps Tips: â€œEachâ€ Loops. Applying DRY principle in CI/CDâ€Šâ€”â€ŠUsingâ€¦ | by Jordan Lee | Medium</a></li>
<li>YAML schema - Azure Pipelines | Microsoft Docs <sup id="fnref2:schema"><a class="footnote-ref" href="../../../azure-pipelines-template-iteration/#fn:schema">1</a></sup></li>
<li>Predefined variables - Azure Pipelines | Microsoft Docs <sup id="fnref2:predefined-variables"><a class="footnote-ref" href="../../../azure-pipelines-template-iteration/#fn:predefined-variables">2</a></sup></li>
<li>Expressions <sup id="fnref3:expressions"><a class="footnote-ref" href="../../../azure-pipelines-template-iteration/#fn:expressions">5</a></sup></li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:schema">
<p><a href="https://bit.ly/3rhAgRd">YAML schema - Azure Pipelines | Microsoft Docs</a>&#160;<a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref:schema" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref2:schema" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:predefined-variables">
<p><a href="https://bit.ly/30a1du6">Predefined variables - Azure Pipelines | Microsoft Docs</a>&#160;<a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref:predefined-variables" title="Jump back to footnote 2 in the text">&#8617;</a><a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref2:predefined-variables" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:json-lines">
<p><a href="https://bit.ly/3bgkTmi">A standard for jsonl</a>&#160;<a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref:json-lines" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref2:json-lines" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:template-context">
<p><a href="https://bit.ly/2OoAXK0">Azure DevOps Template Context</a>&#160;<a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref:template-context" title="Jump back to footnote 4 in the text">&#8617;</a><a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref2:template-context" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:expressions">
<p><a href="https://bit.ly/30bDR7g">Expressions - Azure Pipelines | Microsoft Docs</a>&#160;<a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref:expressions" title="Jump back to footnote 5 in the text">&#8617;</a><a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref2:expressions" title="Jump back to footnote 5 in the text">&#8617;</a><a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref3:expressions" title="Jump back to footnote 5 in the text">&#8617;</a><a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref4:expressions" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:variable-reuse">
<p><a href="https://bit.ly/2OqEreJ">Variable reuse</a>&#160;<a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref:variable-reuse" title="Jump back to footnote 6 in the text">&#8617;</a><a class="footnote-backref" href="../../../azure-pipelines-template-iteration/#fnref2:variable-reuse" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
</ol>
</div>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-02-23 00:00:00">February 23, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="git-workflow-with-git-town"><a class="toclink" href="../../../git-workflow-with-git-town/">Git Workflow With Git Town</a></h2>
<h3 id="resources"><a class="toclink" href="../../../git-workflow-with-git-town/#resources">Resources</a></h3>
<p><a href="https://bit.ly/2OR6zIf">Git-Town</a></p>
<h3 id="painful-but-powerful"><a class="toclink" href="../../../git-workflow-with-git-town/#painful-but-powerful">Painful But Powerful</a></h3>
<p>Let's get this out of the way.</p>
<p>Git isn't intuitive.</p>
<p>It has quite a bit of a learning curve.</p>
<p>However, with this flexibility comes great flexibility.
This tool has powered so much of modern open-source development.</p>
<h3 id="optimize-for-the-pain"><a class="toclink" href="../../../git-workflow-with-git-town/#optimize-for-the-pain">Optimize for the Pain</a></h3>
<p>To improve the development experience some tools can help provide structure.</p>
<p>This won't be an attempt to compare every git GUI, or push any specific tooling.
It's more sharing my experience and what I've found helps accelerate my usage.</p>
<h3 id="tools-ive-relied-on"><a class="toclink" href="../../../git-workflow-with-git-town/#tools-ive-relied-on">Tools I've Relied On</a></h3>
<ul>
<li><a href="https://bit.ly/2OR6zIf">Git-Town</a></li>
<li><a href="https://bit.ly/37F8vu1">Bit</a></li>
<li><a href="https://bit.ly/3boywik">GitHub CLI</a></li>
<li><a href="https://bit.ly/3pEu8AJ">Git Graph</a></li>
<li><a href="https://bit.ly/3dBaUcZ">Git Lens</a></li>
</ul>
<p>I'm not going to go into full detail on each, but check these out to help expedite your workflow.</p>
<h3 id="the-challenge-in-keeping-up-to-date-with-main"><a class="toclink" href="../../../git-workflow-with-git-town/#the-challenge-in-keeping-up-to-date-with-main">The Challenge In Keeping Up To Date With Main</a></h3>
<p>I use what's normally called <code>trunk-based</code> development.
This entails regularly moving commits from branches into the main branch, often rebasing while maintaining it in a functional state.</p>
<p>I'll create a feature branch, bug fix, or refactor branch and then merge this to <code>main</code> as soon as functional.</p>
<p>I prefer a rebase approach on my branches, and when many ci/fix type commits, to squash this into a single unit of work as the results of the PR.
This can result in "merge hell" as you try rebase on a busy repo.</p>
<h3 id="enter-git-town"><a class="toclink" href="../../../git-workflow-with-git-town/#enter-git-town">Enter Git Town</a></h3>
<p>This tool solves so many of the basic workflow issues, that it's become one of the most impactful tools to my daily work.</p>
<p>{{&lt; admonition type="Tip" title="Enable Aliases" closed=false &gt;}}
The examples that follow use <code>git sync</code>, <code>git hack feat/new-feature</code>, etc as examples because I've run the command <code>git-town alias true</code> which enables the alias configuration for git town, reducing verbosity.
Instead of <code>git town sync</code>, you can run <code>git sync</code>.
{{&lt; /admonition &gt;}}</p>
<h4 id="example-1-create-a-branch-for-a-new-unit-of-work-while-you-are-already-on-another-branch"><a class="toclink" href="../../../git-workflow-with-git-town/#example-1-create-a-branch-for-a-new-unit-of-work-while-you-are-already-on-another-branch">Example 1: Create a Branch for a New Unit of Work While You Are Already On Another Branch</a></h4>
<p>Normally this would require:</p>
<ol>
<li>Stash/Push current work</li>
<li>Checkout master</li>
<li>Fetch latest and pull with rebase</li>
<li>Resolve any conflicts from rebase</li>
<li>Create the new branch from main</li>
<li>Switch to the new branch</li>
</ol>
<p>With Git Town</p>
<ol>
<li><code>git hack feat/new-feature</code></li>
</ol>
<h4 id="example-2-sync-main"><a class="toclink" href="../../../git-workflow-with-git-town/#example-2-sync-main">Example 2: Sync Main</a></h4>
<p>The following steps would be performed by: <code>git sync</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>[master] git fetch --prune --tags
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>[master] git add -A
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>[master] git stash
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>[master] git rebase origin/master
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>[master] git push --tags
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>[master] git stash pop
</code></pre></div>
<h4 id="example-3-new-branch-from-main"><a class="toclink" href="../../../git-workflow-with-git-town/#example-3-new-branch-from-main">Example 3: New Branch From Main</a></h4>
<p>Easy to quickly ensure you are up to date with remote and generate a new branch with your current uncommitted changes.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">git</span> <span class="n">town</span> <span class="n">hack</span> <span class="n">fix</span><span class="p">/</span><span class="n">quick-fix</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>[master] git fetch --prune --tags
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>[master] git add -A
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>[master] git stash
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>[master] git rebase origin/master
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>[master] git branch feat/demo-feature master
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>[master] git checkout feat/demo-feature
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>[feat/demo-feature] git stash pop
</code></pre></div>
<h4 id="example-4-quickly-create-a-pr-while-on-a-branch-for-seperate-set-of-changes"><a class="toclink" href="../../../git-workflow-with-git-town/#example-4-quickly-create-a-pr-while-on-a-branch-for-seperate-set-of-changes">Example 4: Quickly Create a PR While On A Branch for Seperate Set of Changes</a></h4>
<p>This workflow is far too tedious to do without tooling like this.</p>
<p>Let's say I'm on a branch doing some work, and then I recognize that another bug, doc improvements, or other change unrelated to my current work would be good to submit.</p>
<p>With git town, it's as simple as:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">git</span> <span class="n">town</span> <span class="n">hack</span> <span class="n">feat</span><span class="p">/</span><span class="n">improve-docs</span>
</code></pre></div>
<p>I can stage individual lines using VSCode for this fix if I want to, and then after committing:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>[feat/demo-feature] git fetch --prune --tags
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>[feat/demo-feature] git add -A
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>[feat/demo-feature] git stash
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>[feat/demo-feature] git checkout master
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>[master] git rebase origin/master
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>[master] git branch feat/demo-feature-2 master
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>[master] git checkout feat/demo-feature-2
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>[feat/demo-feature-2] git stash pop
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">git</span> <span class="n">town</span> <span class="nb">new-pull</span><span class="n">-request</span>
</code></pre></div>
<h4 id="example-5-ship-it"><a class="toclink" href="../../../git-workflow-with-git-town/#example-5-ship-it">Example 5: Ship It</a></h4>
<p>When not using a PR-driven workflow, such as solo projects, then you can still branch and get your work over to main to keep a cleaner history with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">git</span> <span class="n">town</span> <span class="n">ship</span>
</code></pre></div>
<p>This command ensures all the sync features are run, while then initiating a squash of your branch, allow you to edit the squash message, rebase merge this onto main, and finally clean-up the stale branch.</p>
<h4 id="more-examples"><a class="toclink" href="../../../git-workflow-with-git-town/#more-examples">More Examples</a></h4>
<p>Check out the documentation from the creators: <a href="https://bit.ly/3kjgsKy">Git Town Tutorials</a></p>
<h3 id="other-cool-features"><a class="toclink" href="../../../git-workflow-with-git-town/#other-cool-features">Other Cool Features</a></h3>
<ul>
<li>Automatically prune stale branches after PR merge when syncing</li>
<li>Handles perennial branches if you are using Git Flow methodology.</li>
<li>Extensible for other git providers.</li>
<li>Rename a local branch + remote branch in a single command</li>
<li>Handles a lot of edge cases and failures</li>
</ul>
<h3 id="wrap-up"><a class="toclink" href="../../../git-workflow-with-git-town/#wrap-up">Wrap-Up</a></h3>
<p>When using git, leveraging some tooling like this can accelerate your workflow.
I don't think you need to be an expert in git to use this, as it helps simplify many workflows that are just too tedious to be diligent on when running manually.</p>
<p>You can also do much of this with git aliases, but Git Town has a pretty robust feature-set with a testing framework in place, edge condition handling, and it's fast.
Consider using it you'd like to improve your git workflow while simplifying all the effort to do it right.</p>
<h3 id="backlinks"><a class="toclink" href="../../../git-workflow-with-git-town/#backlinks">Backlinks</a></h3>
<ul>
<li>[Git Hub Desktop Quick Look]2021-06-18-git-hub-desktop-quick-look/)<ul>
<li>Update from <code>main</code> already built in.
This is fantastic, and I can see how this provides a UI to do something similar to <a href="https://www.git-town.com/">Git Town</a> which I blogged on earlier here: [2021-02-23-git-workflow-with-git-town]2021-02-23-git-workflow-with-git-town/)</li>
</ul>
</li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-02-15 00:00:00">February 15, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="go-r1-day-28"><a class="toclink" href="../../../go-r1-day-28/">Go R1 Day 28</a></h2>
<h3 id="progress"><a class="toclink" href="../../../go-r1-day-28/#progress">progress</a></h3>
<ul>
<li>Solved [Hamming Distance] on <a href="https://exercism.org/">exercism.io</a></li>
<li>Simple problem, but reminded me of how to use string split.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nx">diffCount</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nx">aString</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">strings</span><span class="p">.</span><span class="nx">Split</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="nx">bString</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">strings</span><span class="p">.</span><span class="nx">Split</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">aString</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">bString</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span><span class="nx">diffCount</span><span class="o">++</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="p">}</span>
</code></pre></div>
<ul>
<li>Reviewed other solutions, and found my first attempt to split the string wasn't necessary.
Looks like I can just iterate on the string directly.
I skipped this as it failed the first time.
The error is: <code>invalid operation: x != b[i] (mismatched types rune and byte)</code>.</li>
</ul>
<p>This threw me for a loop initially, as I'm familar with .NET <code>char</code> datatype.</p>
<blockquote>
<p>Golang doesn't have a char data type. It uses byte and rune to represent character values. The byte data type represents ASCII characters and the rune data type represents a more broader set of Unicode characters that are encoded in UTF-8 format.
<a href="https://www.callicoder.com/golang-basic-types-operators-type-conversion/#integer-type-aliases">Go Data Types</a></p>
</blockquote>
<p>Explictly casting the data types solved the error.
This would be flexibly for UTF8 special characters.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="nb">rune</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">rune</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="nx">diffCount</span><span class="o">++</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">}</span>
</code></pre></div>
<p>With this simple test case, it's it's subjective if I'd need <code>rune</code> instead of just the plain ascii <code>byte</code>, so I finalized my solution with <code>byte(x)</code> instead.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="nb">byte</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">byte</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="nx">diffCount</span><span class="o">++</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="p">}</span>
</code></pre></div>
<h3 id="links"><a class="toclink" href="../../../go-r1-day-28/#links">links</a></h3>
<ul>
<li><a href="https://github.com/sheldonhull/algorithmswithgo.com/tree/master/exercism.io/hamming">hamming-solution</a></li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-02-13 00:00:00">February 13, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="incremental-and-consistent"><a class="toclink" href="../../../incremental-and-consistent/">Incremental and Consistent</a></h2>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Saying that we do knowledge work but have no time for learning is like saying we do farm work but have no time for planting.</p>&mdash; Allen Holub (@allenholub) <a href="https://twitter.com/allenholub/status/1360389911266820096?ref_src=twsrc%5Etfw">February 13, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>It's really hard to prioritize when life gets busy, but it's important that continued improvement is a priority.
<a href="https://www.amazon.com/Great-Work-Performers-Less-Achieve/dp/1501179519">Great at Work: How Top Performers Do Less, Work Better, and Achieve More</a> was a really interesting book.
The fact that small incremental improvement done daily can make such a difference is pretty interesting.
It's similar to Agile tenets in how to approach software design.
Smaller iterations with rapid feedback is better than large isolated batches work delivered without regular feedback.
If you find yourself saying, "But I don't have time" or "When I have some time" it might be indicative of a failure to grasp this.
When I catch myself saying this I try to reword it and say "Whenever I make time for this" instead.
You'll always have pressure on you.
The further along in your career and life you go, the more pressure is likely to be on you.
You have to "make" time for improvement and learning if it's a priority.</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-02-09 00:00:00">February 9, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              7 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="working-with-powershell-objects-to-create-yaml"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/">Working With Powershell Objects to Create Yaml</a></h2>
<h3 id="who-this-might-be-for"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#who-this-might-be-for">Who This Might Be For</a></h3>
<ul>
<li>PowerShellers wanting to know how to create json and yaml dynamically via <code>pscustomobject</code>.</li>
<li>Anyone wanting to create configs like Datadog or other tools dynamically without the benefit of a configuration management tool.</li>
<li>Anyone else wanting to fall asleep more quickly. (I can think of better material such as the Go spec docs, but hey, I can't argue with your good taste ðŸ˜„)</li>
</ul>
<h3 id="yaml"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#yaml">YAML</a></h3>
<p>It's readable.</p>
<p>It's probably cost all of us hours when debugging yaml that's nested several layers and an errant whitespace got in.</p>
<p>It's here to stay.</p>
<p>I prefer it over JSON for readability, but I prefer JSON for programmability.</p>
<p>Sometimes though, tooling uses yaml, and we need to be able to flip between both.</p>
<p>Historically I've used <code>cfn-flip</code> which is pretty great.</p>
<h3 id="enter-yq"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#enter-yq">Enter yq</a></h3>
<p>The problem I have with using <code>cfn-flip</code> is dependencies.
It's a bit crazy to setup a docker image and then need to install a bunch of python setup tools to just get this one tool when it's all I need.</p>
<p>I thought about building a quick <code>Go</code> app to do this and give me the benefit of a single binary, as there is a pretty useful <code>yaml</code> package already.
Instead, I found a robust package that is cross-platform called <code>yq</code> and it's my new go to. ðŸŽ‰</p>
<h3 id="just-plain-works"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#just-plain-works">Just plain works</a></h3>
<p><a href="http://bit.ly/3pphpTb">The docs are great</a></p>
<p>Reading <code>STDIN</code> is a bit clunky, but not too bad, though I wish it would take more of a pipeline input approach natively.
Instead of passing in <code>{"string":"value"} | yq</code> it requires you to specify <code>stringinput | yq eval - --prettyPrint</code> .
Note the single hyphen after eval. This is what signifies that the input is <code>STDIN</code>.</p>
<h3 id="dynamically-generate-some-configs"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#dynamically-generate-some-configs">Dynamically Generate Some Configs</a></h3>
<p>I was working on some Datadog config generation for SQL Server, and found this tooling useful, especially on older Windows instances that didn't have the capability to run the nice module <a href="http://bit.ly/3j4D94J">powershell-yaml</a>.</p>
<p>Here's how to use PowerShell objects to help generate a yaml configuration file on demand.</p>
<h4 id="install"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#install">Install</a></h4>
<p>See install directions for linux/mac, as it's pretty straightforward.</p>
<p>For windows, the chocolatey package was outdated as of the time of the article using the version 3.x.</p>
<p>I used a PowerShell 4.0 compatible syntax here that should work on any instances with access to the web.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="no">[Net.ServicePointManager]</span><span class="p">::</span><span class="n">SecurityProtocol</span> <span class="p">=</span> <span class="no">[Net.SecurityProtocolType]</span><span class="p">::</span><span class="n">Tls12</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">-PathType</span> <span class="n">Leaf</span><span class="p">))</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="p">{</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>        <span class="nv">$ProgressPreference</span> <span class="p">=</span> <span class="s1">&#39;SilentlyContinue&#39;</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>        <span class="nb">New-Item</span> <span class="s1">&#39;C:\tools&#39;</span> <span class="n">-ItemType</span> <span class="n">Directory</span> <span class="n">-Force</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>        <span class="nb">Invoke-WebRequest</span> <span class="s1">&#39;https://github.com/mikefarah/yq/releases/download/v4.4.1/yq_windows_amd64.exe&#39;</span> <span class="n">-OutFile</span> <span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">-UseBasicParsing</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>        <span class="nb">Unblock-File</span> <span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">-Confirm</span><span class="p">:</span><span class="nv">$false</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="p">}</span>
</code></pre></div>
<p>Once this was downloaded, you could either make sure <code>C:\tools</code> was in <code>PATH</code> or just use the fully qualified path for our simple use case.</p>
<h4 id="get-aws-metadata"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#get-aws-metadata">Get AWS Metadata</a></h4>
<p>In AWS, I parsed the metadata for the AccountID and InstanceID to generate a query to pull the Name tag dynamically.</p>
<p>{{&lt; admonition type="Tip" title="Permissions Check" &gt;}}
You must have the required permissions for the instance profile for this to work.
This is not an instance level permission, so you'll want to add the required DescribeTags and ListInstances permissions for using a command such as <code>Get-EC2Tag</code>
{{&lt; /admonition &gt;}}</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nb">Import-Module</span> <span class="n">AWSPowershell</span> <span class="n">-Verbose</span><span class="p">:</span><span class="nv">$false</span> <span class="p">*&gt;</span> <span class="nv">$null</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c"># AWSPowerShell is the legacy module, but is provided already on most AWS instances</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="nv">$response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="s1">&#39;http://169.254.169.254/latest/dynamic/instance-identity/document&#39;</span> <span class="n">-TimeoutSec</span> <span class="n">5</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="nv">$AccountId</span> <span class="p">=</span> <span class="nv">$response</span><span class="p">.</span><span class="n">AccountId</span>
</code></pre></div>
<h4 id="pull-back-ec2-tags"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#pull-back-ec2-tags">Pull Back EC2 Tags</a></h4>
<p>Now we can pull back the tag using an EC2 instance filter object.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nv">$filters</span> <span class="p">=</span> <span class="p">@(</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>      <span class="no">[Amazon.EC2.Model.Filter]</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;resource-id&#39;</span><span class="p">,</span> <span class="nv">$response</span><span class="p">.</span><span class="n">InstanceId</span><span class="p">)</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>  <span class="p">)</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>  <span class="nv">$tags</span> <span class="p">=</span> <span class="nb">Get-EC2Tag</span> <span class="n">-Filters</span> <span class="nv">$filters</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>  <span class="nv">$tagcollection</span> <span class="p">=</span> <span class="nv">$tags</span><span class="p">.</span><span class="k">ForEach</span><span class="p">{</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>      <span class="nv">$t</span> <span class="p">=</span> <span class="nv">$_</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>      <span class="no">[pscustomobject]</span><span class="p">@{</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>          <span class="n">Name</span>  <span class="p">=</span> <span class="nv">$t</span><span class="p">.</span><span class="n">name</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>          <span class="n">Value</span> <span class="p">=</span> <span class="nv">$t</span><span class="p">.</span><span class="n">value</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>      <span class="p">}</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>  <span class="p">}</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>  <span class="nb">Write-Host</span> <span class="s2">&quot;Tags For Instance: </span><span class="p">$(</span><span class="nv">$tagcollection</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-AutoSize</span> <span class="n">-Wrap</span> <span class="p">|</span> <span class="nb">Out-String</span><span class="p">)</span><span class="s2">&quot;</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>  <span class="nv">$HostName</span> <span class="p">=</span> <span class="nv">$Tags</span><span class="p">.</span><span class="n">GetEnumerator</span><span class="p">().</span><span class="n">Where</span><span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Key</span> <span class="o">-eq</span> <span class="s1">&#39;Name&#39;</span> <span class="p">}.</span><span class="n">Value</span><span class="p">.</span><span class="n">ToLower</span><span class="p">().</span><span class="n">Trim</span><span class="p">()</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>  <span class="nv">$SqlInstance</span> <span class="p">=</span> <span class="nv">$HostName</span>
</code></pre></div>
<h4 id="switch-things-up-with-a-switch"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#switch-things-up-with-a-switch">Switch Things Up With A Switch</a></h4>
<p>The next step was to alias the instance.</p>
<p>The better way to do this would be to use a tag that it reads, but for my quick ad-hoc use, this just let me specific an explicit alias to generate as a tag in the yaml. Again, try to use the Datadog tagging feature to do this automatically if possible.</p>
<p>{{&lt; admonition type="Tip" title="Switch Statements" &gt;}}
If you aren't familiar with PowerShell's switch statement, it's a nice little feature for making this evaluation easy to read.</p>
<p>For the breadth of what this cool language feature can do, check this article out:</p>
<p><a href="http://bit.ly/3pwnei0">Everything you ever wanted to know about the switch statement</a>
{{&lt; /admonition &gt;}}</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">switch</span> <span class="p">(</span><span class="nv">$AccountId</span><span class="p">)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="p">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="s1">&#39;12345&#39;</span> <span class="p">{</span> <span class="nv">$AWSAccountAlias</span>  <span class="p">=</span> <span class="s1">&#39;mydevenv&#39;</span> <span class="p">;</span> <span class="nv">$stage</span> <span class="p">=</span> <span class="s1">&#39;qa&#39;</span> <span class="p">}</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="s1">&#39;12345&#39;</span> <span class="p">{</span> <span class="nv">$AWSAccountAlias</span>  <span class="p">=</span> <span class="s1">&#39;myprodenv&#39;</span> <span class="p">;</span> <span class="nv">$stage</span> <span class="p">=</span> <span class="s1">&#39;prod&#39;</span> <span class="p">}</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="k">default</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    <span class="p">{</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>        <span class="k">throw</span> <span class="s2">&quot;Couldn&#39;t match a valid account number to give this an alias&quot;</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>    <span class="p">}</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="p">}</span>
</code></pre></div>
<p>Now, preview the results of this Frankenstein.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nb">Write-Host</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span> <span class="p">(</span><span class="s2">&quot;</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="se">`$</span><span class="s2">HostName        = $HostName</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="se">`$</span><span class="s2">SqlInstance     = $SqlInstance</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="se">`$</span><span class="s2">AWSAccountAlias = $AWSAccountAlias</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="se">`$</span><span class="s2">stage           = $stage</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="s2"> &quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="ready-to-generate-some-yaml-magic"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#ready-to-generate-some-yaml-magic">Ready To Generate Some Yaml Magic</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nv">$TargetConfig</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Join-Path</span> <span class="nv">$ENV:ProgramData</span> <span class="s1">&#39;Datadog/conf.d/windows_service.d/conf.yaml&#39;</span><span class="p">)</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nv">$Services</span> <span class="p">=</span> <span class="no">[pscustomobject]</span><span class="p">@{</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    <span class="s1">&#39;instances&#39;</span> <span class="p">=</span> <span class="p">@(</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>        <span class="no">[ordered]</span><span class="p">@{</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>            <span class="s1">&#39;services&#39;</span>                   <span class="p">=</span>  <span class="p">@(</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>                <span class="s1">&#39;SQLSERVERAGENT&#39;</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>                <span class="s1">&#39;MSSQLSERVER&#39;</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>                <span class="s1">&#39;SQLSERVERAGENT&#39;</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>            <span class="p">)</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>            <span class="s1">&#39;disable_legacy_service_tag&#39;</span> <span class="p">=</span> <span class="nv">$true</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>            <span class="s1">&#39;tags&#39;</span>                       <span class="p">=</span> <span class="p">@(</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>                <span class="s2">&quot;aws_account_alias:$AWSAccountAlias&quot;</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>                <span class="s2">&quot;sql_instance:$SqlInstance&quot;</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>                <span class="s2">&quot;stage:$stage&quot;</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>            <span class="p">)</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>        <span class="p">}</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>    <span class="p">)</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="p">}</span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="nv">$Services</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">100</span> <span class="p">|</span> <span class="p">&amp;</span><span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">eval</span> <span class="p">-</span> <span class="p">-</span><span class="n">-prettyPrint</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$TargetConfig</span> <span class="n">-Encoding</span> <span class="n">UTF8</span>
</code></pre></div>
<p>This would produce a nice json output like this</p>
<p><img alt="Example config image" src="../../images/2021-02-08-yaml-config-example.png" /></p>
<h4 id="one-more-complex-example"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#one-more-complex-example">One More Complex Example</a></h4>
<p>Start with creating an empty array and some variables to work with.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="nv">$UserName</span> <span class="p">=</span> <span class="s1">&#39;TacoBear&#39;</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="nv">$Password</span> <span class="p">=</span> <span class="s1">&#39;YouReallyThinkI&#39;&#39;dPostThis?Funny&#39;</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="nv">$TargetConfig</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Join-Path</span> <span class="nv">$ENV:ProgramData</span> <span class="s1">&#39;Datadog/conf.d/sqlserver.d/conf.yaml&#39;</span><span class="p">)</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="nv">$Queries</span> <span class="p">=</span> <span class="p">@()</span>
</code></pre></div>
<p>Next include the generic Datadog collector definition.</p>
<p>This is straight outta their <a href="http://bit.ly/3cisxgY">Github repo</a> with the benefit of some tagging.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nv">$Queries</span> <span class="p">+=</span> <span class="no">[ordered]</span><span class="p">@{</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>    <span class="s1">&#39;host&#39;</span>      <span class="p">=</span><span class="s1">&#39;tcp:localhost,1433&#39;</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>    <span class="s1">&#39;username&#39;</span>  <span class="p">=</span><span class="nv">$UserName</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    <span class="s1">&#39;password&#39;</span>  <span class="p">=</span> <span class="nv">$Password</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="s1">&#39;connector&#39;</span> <span class="p">=</span><span class="s1">&#39;adodbapi&#39;</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="s1">&#39;driver&#39;</span>    <span class="p">=</span> <span class="s1">&#39;SQL Server&#39;</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    <span class="s1">&#39;database&#39;</span>  <span class="p">=</span> <span class="s1">&#39;master&#39;</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    <span class="s1">&#39;tags&#39;</span>      <span class="p">=</span> <span class="p">@(</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>        <span class="s2">&quot;aws_account_alias:$AWSAccountAlias&quot;</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>        <span class="s2">&quot;sql_instance:$SqlInstance&quot;</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>        <span class="s2">&quot;stage:$stage&quot;</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>    <span class="p">)</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="p">}</span>
</code></pre></div>
<p>{{&lt; admonition type="Tip" title="Using += for Collections" &gt;}}
Using <code>+=</code> is a bit of an anti-pattern for high performance PowerShell, but it works great for something like this that's ad-hoc and needs to be simple.
For high performance needs, try using something like <code>$list = [Systems.Collections.Generic.List[pscustomobject]]:new()</code> for example.
This can then allow you to use the <code>$list.Add([pscustomobject]@{}</code> to add items.</p>
<p>A bit more complex, but very powerful and performance, with the benefit of stronger data typing.
{{&lt; /admonition &gt;}}</p>
<p>This one is a good example of the custom query format that Datadog supports, but honestly I found pretty confusing in their docs until I bumbled my way through a few iterations.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nv">$Queries</span> <span class="p">+=</span>    <span class="no">[ordered]</span><span class="p">@{</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>    <span class="c"># description: Not Used by Datadog, but helpful to reading the yaml, be kind to those folks!</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="s1">&#39;description&#39;</span>             <span class="p">=</span> <span class="s1">&#39;Get Count of Databases on Server&#39;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    <span class="s1">&#39;host&#39;</span>                    <span class="p">=</span><span class="s1">&#39;tcp:localhost,1433&#39;</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="s1">&#39;username&#39;</span>                <span class="p">=</span> <span class="nv">$UserName</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="s1">&#39;database&#39;</span>                <span class="p">=</span> <span class="s1">&#39;master&#39;</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>    <span class="s1">&#39;password&#39;</span>                <span class="p">=</span> <span class="nv">$Password</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>    <span class="s1">&#39;connector&#39;</span>               <span class="p">=</span><span class="s1">&#39;adodbapi&#39;</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>    <span class="s1">&#39;driver&#39;</span>                  <span class="p">=</span> <span class="s1">&#39;SQL Server&#39;</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>    <span class="s1">&#39;min_collection_interval&#39;</span> <span class="p">=</span> <span class="no">[timespan]</span><span class="p">::</span><span class="n">FromHours</span><span class="p">(</span><span class="n">1</span><span class="p">).</span><span class="n">TotalSeconds</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>    <span class="s1">&#39;command_timeout&#39;</span>         <span class="p">=</span> <span class="n">120</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>    <span class="s1">&#39;custom_queries&#39;</span>          <span class="p">=</span> <span class="p">@(</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>        <span class="no">[ordered]</span><span class="p">@{</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>            <span class="s1">&#39;query&#39;</span>   <span class="p">=</span> <span class="s2">&quot;select count(name) from sys.databases as d where d.Name not in (&#39;master&#39;, &#39;msdb&#39;, &#39;model&#39;, &#39;tempdb&#39;)&quot;</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>            <span class="s1">&#39;columns&#39;</span> <span class="p">=</span> <span class="p">@(</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>                <span class="no">[ordered]</span><span class="p">@{</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>                    <span class="s1">&#39;name&#39;</span> <span class="p">=</span> <span class="s1">&#39;instance.database_count&#39;</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>                    <span class="s1">&#39;type&#39;</span> <span class="p">=</span> <span class="s1">&#39;gauge&#39;</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>                    <span class="s1">&#39;tags&#39;</span> <span class="p">=</span> <span class="p">@(</span>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>                        <span class="s2">&quot;aws_account_alias:$AWSAccountAlias&quot;</span>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>                        <span class="s2">&quot;sql_instance:$SqlInstance&quot;</span>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>                        <span class="s2">&quot;stage:$stage&quot;</span>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a>                    <span class="p">)</span>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a>                <span class="p">}</span>
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a>            <span class="p">)</span>
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a>        <span class="p">}</span>
<a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a>    <span class="p">)</span>
<a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a><span class="p">}</span>
</code></pre></div>
<p>Let me do a quick breakdown, in case you aren't as familiar with this type of syntax in PowerShell.</p>
<ol>
<li><code>$Queries +=</code> takes whatever existing object we have and replaces it with the current object + the new object. This is why it's not performant for large scale work as it's basically creating a whole new copy of the collection with your new addition.</li>
<li>Next, I'm using <code>[ordered]</code> instead of <code>[pscustomobject]</code> which in effect does the same thing, but ensures I'm not having all my properties randomly sorted each time. Makes things a little easier to review. This is a shorthand syntax for what would be a much longer tedious process using <code>New-Object</code> and <code>Add-Member</code>.</li>
<li>Custom queries is a list, so I cast it with <code>@()</code> format, which tells PowerShell to expect a list. This helps json/yaml conversion be correct even if you have just a single entry. You can be more explicit if you want, like <code>[pscustomobject[]]@()</code> but since PowerShell ignores you mostly on trying to be type specific, it's not worth it. Don't try to make PowerShell be Go or C#. ðŸ˜</li>
</ol>
<h4 id="flip-to-yaml"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#flip-to-yaml">Flip To Yaml</a></h4>
<p>Ok, we have an object list, now we need to flip this to yaml.</p>
<p>It's not as easy as <code>$Queries | yq</code> because of the difference in paradigm with .NET.</p>
<p>We are working with a structured object.</p>
<p>Just look at <code>$Queries | Get-Member</code> and you'll probably get: <code>TypeName: System.Collections.Specialized.OrderedDictionary.</code> The difference is that Go/Linux paradigm is focused on text, not objects. With <code>powershell-yaml</code> module you can run <code>ConvertTo-Yaml $Queries</code> and it will work as it will handle the object transformation.</p>
<p>However, we can actually get there with PowerShell, just need to think of a text focused paradigm instead. This is actually pretty easy using <code>Converto-Json</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nv">$SqlConfig</span> <span class="p">=</span> <span class="no">[ordered]</span><span class="p">@{</span><span class="s1">&#39;instances&#39;</span> <span class="p">=</span> <span class="nv">$Queries</span> <span class="p">}</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="nv">$SqlConfig</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">100</span> <span class="p">|</span> <span class="p">&amp;</span><span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">eval</span> <span class="p">-</span> <span class="p">-</span><span class="n">-prettyPrint</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$TargetConfig</span> <span class="n">-Encoding</span> <span class="n">UTF8</span>
</code></pre></div>
<p>This takes the object, converts to json uses the provided cmdlet from PowerShell that knows how to properly take the object and all the nested properties and magically split to <code>JSON</code>.  Pass this into the <code>yq</code> executable, and behold, the magic is done.</p>
<p>You should have a nicely formatted yaml configuration file for Datadog.</p>
<p>If not, the dog will yip and complain with a bunch of red text in the log.</p>
<h4 id="debug-helper"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#debug-helper">Debug Helper</a></h4>
<p>Use this on the remote instance to simplify some debugging, or even connect via SSM directly.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="p">&amp;</span> <span class="s2">&quot;$env:ProgramFiles\Datadog\Datadog Agent\bin\agent.exe&quot;</span> <span class="n">stopservice</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="p">&amp;</span> <span class="s2">&quot;$env:ProgramFiles\Datadog\Datadog Agent\bin\agent.exe&quot;</span> <span class="nb">start-service</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c">#Stream Logs without gui if remote session using:</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="nb">Get-Content</span> <span class="s1">&#39;C:\ProgramData\Datadog\logs\agent.log&#39;</span> <span class="n">-Tail</span> <span class="n">5</span> <span class="n">-Wait</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c"># interactive debugging and viewing of console</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="c"># &amp; &quot;$env:ProgramFiles\Datadog\Datadog Agent\bin\agent.exe&quot; launch-gui</span>
</code></pre></div>
<h3 id="wrap-up"><a class="toclink" href="../../../working-with-powershell-objects-to-create-yaml/#wrap-up">Wrap Up</a></h3>
<p>Ideally, use Chef, Ansible, Saltstack, DSC, or another tool to do this. However, sometimes you just need some flexible options for generating this type of content dynamically. Hopefully, you'll find this useful in your PowerShell magician journey and save some time.</p>
<p>I've already found it useful in flipping json content for various tools back and forth. ðŸŽ‰</p>
<p>A few scenarios that tooling like yq might prove useful could be:</p>
<ul>
<li>convert simple query results from json to yaml and store in git as config</li>
<li>Flip an SSM Json doc to yaml</li>
<li>Review a complex json doc by flipping to yaml for more readable syntax</li>
<li>Confusing co-workers by flipping all their cloudformation from yaml to json or yaml from json. (If you take random advice like this and apply, you probably deserve the aftermath this would bring ðŸ¤£.)</li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-01-25 00:00:00">January 25, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="nativefier"><a class="toclink" href="../../../nativefier/">Nativefier</a></h2>
<p>{{&lt; admonition type="Info" title="Update 2021-09-20" open="true"&gt;}}
Updated with improved handling using public docker image.
{{&lt; /admonition &gt;}}
{{&lt; admonition type="Info" title="Update 2021-05-10" open="true"&gt;}}
Added additional context for setting <code>internal-urls</code> via command line.
{{&lt; /admonition &gt;}}</p>
<p>{{&lt; admonition type="Info" title="Update 2021-05-13" open="true"&gt;}}
Added docker run commands to simplify local build and run without global install.
{{&lt; /admonition &gt;}}</p>
<p>Ran across this app, and thought was kinda cool.
I've had some issues with Chrome apps showing up correctly in certain macOS windows managers to switch context quickly.</p>
<p>Using this tool, you can generate a standalone electron app bundle to run a webpage in as it's own dedicated window.</p>
<p>It's cross-platform.</p>
<p>If you are using an app like Azure Boards that doesn't offer a native app, then this can provide a slightly improved experience over Chrome shortcut apps.
You can pin this to your tray and treat it like a native app.</p>
<h3 id="docker-setup"><a class="toclink" href="../../../nativefier/#docker-setup">Docker Setup</a></h3>
<p>{{&lt; admonition type="Note" title="Optional - Build Locally" open=false &gt;}}
This step is no longer required per public docker image.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">cd </span><span class="p">~/</span><span class="n">git</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">gh</span> <span class="n">repo</span> <span class="n">clone</span> <span class="n">nativefier</span><span class="p">/</span><span class="n">nativefier</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nb">cd </span><span class="n">nativefier</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">docker</span> <span class="n">build</span> <span class="n">-t</span> <span class="n">local</span><span class="p">/</span><span class="n">nativefier</span> <span class="p">.</span>
</code></pre></div>
<p>{{&lt; /admonition &gt;}}</p>
<h3 id="docker-build"><a class="toclink" href="../../../nativefier/#docker-build">Docker Build</a></h3>
<p>Highly recommend using docker for the build as it was by far the less complicated.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">docker</span> <span class="n">run</span> <span class="p">-</span><span class="n">-rm</span> <span class="n">-v</span> <span class="p">~/</span><span class="n">nativefier-apps</span><span class="p">:/</span><span class="n">target</span><span class="p">/</span> <span class="n">local</span><span class="p">/</span><span class="n">nativefier</span><span class="p">:</span><span class="n">latest</span> <span class="p">-</span><span class="n">-help</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="nv">$MYORG</span> <span class="p">=</span> <span class="s1">&#39;foo&#39;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="nv">$MYPROJECT</span> <span class="p">=</span> <span class="s1">&#39;bar&#39;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="nv">$AppName</span>      <span class="p">=</span> <span class="s1">&#39;myappname&#39;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="nv">$Platform</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="k">switch</span> <span class="o">-Wildcard</span> <span class="p">(</span><span class="no">[System.Environment]</span><span class="p">::</span><span class="n">OSVersion</span><span class="p">.</span><span class="n">Platform</span><span class="p">)</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="p">{</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>    <span class="s1">&#39;Win32NT&#39;</span> <span class="p">{</span> <span class="nv">$Platform</span> <span class="p">=</span> <span class="s1">&#39;windows&#39;</span> <span class="p">}</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>    <span class="s1">&#39;Unix&#39;</span>    <span class="p">{</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>                <span class="k">if</span> <span class="p">(</span><span class="nv">$PSVersionTable</span><span class="p">.</span><span class="n">OS</span> <span class="o">-match</span> <span class="s1">&#39;Darwin&#39;</span><span class="p">)</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>                <span class="p">{</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>                    <span class="nv">$Platform</span> <span class="p">=</span> <span class="s1">&#39;darwin&#39;</span><span class="p">;</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>                    <span class="nv">$DarkMode</span> <span class="p">=</span> <span class="s1">&#39;--darwin-dark-mode-support&#39;</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>                <span class="p">}</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>                <span class="k">else</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>                <span class="p">{</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>                    <span class="nv">$Platform</span> <span class="p">=</span> <span class="s1">&#39;linux&#39;</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>                <span class="p">}</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>            <span class="p">}</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>    <span class="k">default</span> <span class="p">{</span> <span class="nb">Write-Warning</span> <span class="s1">&#39;No match found in switch&#39;</span> <span class="p">}</span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="p">}</span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="nv">$InternalUrls</span> <span class="p">=</span> <span class="s1">&#39;(._?contacts\.google\.com._?|._?dev.azure.com_?|._?microsoft.com_?|._?login.microsoftonline.com_?|._?azure.com_?|._?vssps.visualstudio.com._?)&#39;</span>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="nv">$Url</span>          <span class="p">=</span> <span class="s2">&quot;https://dev.azure.com/$MYORG/$MYPROJECT/_sprints/directory?fullScreen=true/&quot;</span>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="nv">$HomeDir</span> <span class="p">=</span> <span class="s2">&quot;${ENV:HOME}${ENV:USERPROFILE}&quot;</span> <span class="c"># cross platform support</span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="nv">$PublishDirectory</span> <span class="p">=</span> <span class="nb">Join-Path</span> <span class="s2">&quot;${ENV:HOME}${ENV:USERPROFILE}&quot;</span> <span class="s1">&#39;nativefier-apps&#39;</span>
<a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="nv">$PublishAppDirectory</span> <span class="p">=</span> <span class="nb">Join-Path</span> <span class="nv">$PublishDirectory</span> <span class="s2">&quot;$AppName-$Platform-x64&quot;</span>
<a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>
<a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a><span class="nb">Remove-Item</span> <span class="n">-LiteralPath</span> <span class="nv">$PublishAppDirectory</span> <span class="n">-Recurse</span> <span class="n">-Force</span>
<a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a><span class="n">docker</span> <span class="n">run</span> <span class="p">-</span><span class="n">-rm</span> <span class="n">-v</span>  <span class="nv">$HomeDir</span><span class="p">/</span><span class="n">nativefier-apps</span><span class="p">:/</span><span class="n">target</span><span class="p">/</span> <span class="n">nativefier</span><span class="p">/</span><span class="n">nativefier</span><span class="p">:</span><span class="n">latest</span> <span class="p">-</span><span class="n">-name</span> <span class="nv">$AppName</span> <span class="p">-</span><span class="n">-platform</span> <span class="nv">$Platform</span> <span class="nv">$DarkMode</span> <span class="p">-</span><span class="n">-internal-urls</span> <span class="nv">$InternalUrls</span> <span class="nv">$Url</span> <span class="p">/</span><span class="n">target</span><span class="p">/</span>
</code></pre></div>
<h3 id="running-the-cli"><a class="toclink" href="../../../nativefier/#running-the-cli">Running The CLI</a></h3>
<p>For a site like Azure DevOps, you can run:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nv">$MYORG</span> <span class="p">=</span> <span class="s1">&#39;foo&#39;</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nv">$MYPROJECT</span> <span class="p">=</span> <span class="s1">&#39;bar&#39;</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="nv">$BOARDNAME</span> <span class="p">=</span> <span class="s1">&#39;bored&#39;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">nativefier</span> <span class="p">-</span><span class="n">-name</span> <span class="s1">&#39;board&#39;</span> <span class="n">https</span><span class="p">://</span><span class="n">dev</span><span class="p">.</span><span class="n">azure</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="nv">$MYORG</span><span class="p">/</span><span class="nv">$MYPROJECT</span><span class="p">/</span><span class="n">_boards</span><span class="p">/</span><span class="n">board</span><span class="p">/</span><span class="n">t</span><span class="p">/</span><span class="nv">$BOARDNAME</span><span class="p">/</span><span class="n">Backlog</span><span class="k">%</span><span class="n">20items</span><span class="p">/</span><span class="k">?</span><span class="n">fullScreen</span><span class="p">=</span><span class="n">true</span> <span class="p">~/</span><span class="nv">$BOARDNAME</span>
</code></pre></div>
<p>Here's another example using more custom options to enable internal url authentication and setup an app for a sprint board.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">nativefier</span> <span class="p">-</span><span class="n">-name</span> <span class="s2">&quot;sprint-board&quot;</span> <span class="p">-</span><span class="n">-darwin-dark-mode-support</span> <span class="p">`</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>  <span class="p">-</span><span class="n">-internal-urls</span> <span class="s1">&#39;(._?contacts.google.com._?|._?dev.azure.com_?|._?microsoft.com_?|._?login.microsoftonline.com_?|._?azure.com_?|._?vssps.visualstudio.com._?)&#39;</span> <span class="p">`</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>  <span class="s2">&quot;https://dev.azure.com/$MYORG/$MYPROJECT/_sprints/directory?fullScreen=true&quot;</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>  <span class="p">`</span> <span class="p">~/</span><span class="n">sprint-board</span>
</code></pre></div>
<p>If redirects for permissions occur due to external links opening, you might have to open the application bundle and edit the url mapping. <a href="https://github.com/jiahaog/nativefier/issues/706">GitHub Issue #706</a>
This can be done proactively in the <code>--internal-urls</code> command line argument shown earlier to bypass the need to do this later.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>/Users/$(whoami)/$BOARDNAME/APP-darwin-x64/$BOARDNAME.app/Contents/Resources/app/nativefier.json
</code></pre></div>
<p>Ensure your external urls match the redirect paths that you need such as below.
I included the standard oauth redirect locations that Google, Azure DevOps, and Microsoft uses.
Add your own such as github to this to have those links open inside the app and not in a new window that fails to recieve the postback.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nt">&quot;internalUrls&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;(._?contacts\.google\.com._?|._?dev.azure.com_?|._?microsoft.com_?|._?login.microsoftonline.com_?|._?azure.com_?|._?vssps.visualstudio.com._?)&quot;</span><span class="p">,</span>
</code></pre></div>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-01-22 00:00:00">January 22, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="go-r1-day-27"><a class="toclink" href="../../../go-r1-day-27/">Go R1 Day 27</a></h2>
<h3 id="progress"><a class="toclink" href="../../../go-r1-day-27/#progress">progress</a></h3>
<ul>
<li>Iterated through AWS SDK v1 S3 buckets to process IAM policy permissions.</li>
<li>Unmarshaled policy doc into struct using <code>Json-To-Struct</code>.</li>
</ul>
<h3 id="links"><a class="toclink" href="../../../go-r1-day-27/#links">links</a></h3>
<ul>
<li><a href="https://mholt.github.io/json-to-go/">JSON-to-Go</a></li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-01-21 00:00:00">January 21, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="github-pages-now-supports-private-pages"><a class="toclink" href="../../../github-pages-now-supports-private-pages/">Github Pages Now Supports Private Pages</a></h2>
<p>I'm a huge static site fan (lookup jamstack).</p>
<p>What I've historically had a problem with was hosting.
For public pages, it's great.</p>
<p>For private internal docs, it's been problematic.
It's more servers and access control to manage if you want something for a specific group inside a company to access.</p>
<p>This new update is a big deal for those that want to provide an internal hugo, jekyll, mkdocs, or other static generate based documentation site for their team.</p>
<p><a href="http://bit.ly/2MdUeg9">Access control for GitHub Pages - GitHub Changelog</a></p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-01-20 00:00:00">January 20, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ensuring-profile-environment-variables-available-to-intellij"><a class="toclink" href="../../../ensuring-profile-environment-variables-available-to-intellij/">Ensuring Profile Environment Variables Available to Intellij</a></h2>
<p>Open IntelliJ via terminal: <code>open "/Users/$(whoami)/Applications/JetBrains Toolbox/IntelliJ IDEA Ultimate.app"</code></p>
<p>This will ensure your <code>.profile</code>, <code>.bashrc</code>, and other profile settings that might be loading some default environment variables are available to your IDE.
For macOS, you'd have to set in the <code>environment.plist</code> otherwise to ensure they are available to a normal application.</p>
<p>ref: <a href="http://bit.ly/3p3BgHy">OSX shell environment variables â€“ IDEs Support (IntelliJ Platform) | JetBrains</a></p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-01-18 00:00:00">January 18, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="create-an-s3-lifecycle-policy-with-powershell"><a class="toclink" href="../../../create-an-s3-lifecycle-policy-with-powershell/">Create an S3 Lifecycle Policy with PowerShell</a></h2>
<p>First, I'm a big believer in doing infrastructure as code.</p>
<p>Using the AWS SDK with any library is great, but for things like S3 I'd highly recommend you use a Terraform module such as <a href="https://registry.terraform.io/modules/cloudposse/s3-bucket/aws/latest">Cloudposse terraform-aws-s3-bucket module</a>.
Everything Cloudposse produces has great quality, flexibility with naming conventions, and more.</p>
<p>Now that this disclaimer is out of the way, I've run into scenarios where you can have a bucket with a large amount of data such as databases which would be good to do some cleanup on before you migrate to newly managed backups.</p>
<p>In my case, I've run into 50TB of old backups due to tooling issues that prevented cleanup from being successful.
The backup tooling stored a sqlite database in one subdirectory and in another directory the actual backups.</p>
<p>I preferred at this point to only perform the lifecycle cleanup on the backup files, while leaving the sqlite file alone. (side note: i always feel strange typing sqlite, like I'm skipping an l ðŸ˜).</p>
<p>Here's an example of how to do this from the AWS PowerShell docs.</p>
<p>I modified this example to support providing multiple key prefixes.
What wasn't quite clear when I did this the need to create the entire lifecycle policy collection as a single object and pass this to the command.</p>
<p>If you try to run a loop and create one lifecycle policy for each <code>Write-S3LifecycleConfiguration</code> command, it only kept what last ran.
Instead, ensure you create the entire object as shown in the example, and then you'll be able to have multiple lifecycle policies get attached to your bucket.</p>
<p>Good luck!</p>
<script src="https://gist.github.com/sheldonhull/ad168faccb06cd0387bcebfdf99da3d6.js"></script>
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../../">1</a> <span class="md-pagination__dots">..</span> <a class="md-pagination__link" href="../8/">8</a> <a class="md-pagination__link" href="../9/">9</a> <span class="md-pagination__current">10</span> <a class="md-pagination__link" href="../11/">11</a>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.follow", "navigation.top", "navigation.path", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.4.0/dist/mermaid.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>